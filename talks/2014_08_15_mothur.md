--- 
title       : mothur
subtitle    : 
date        : August 15, 2014
author      : Patrick D. Schloss, PhD (@PatSchloss)
job         : Department of Microbiology & Immunology
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : tomorrow      # 
widgets     : []            # {mathjax, quiz, bootstrap}
mode        : standalone    # {selfcontained, standalone, draft}
knit        : slidify::knit2slides

--- .segue .dark

## Background 
<script type="text/javascript">
CanvasMatrix4=function(m){if(typeof m=='object'){if("length"in m&&m.length>=16){this.load(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8],m[9],m[10],m[11],m[12],m[13],m[14],m[15]);return}else if(m instanceof CanvasMatrix4){this.load(m);return}}this.makeIdentity()};CanvasMatrix4.prototype.load=function(){if(arguments.length==1&&typeof arguments[0]=='object'){var matrix=arguments[0];if("length"in matrix&&matrix.length==16){this.m11=matrix[0];this.m12=matrix[1];this.m13=matrix[2];this.m14=matrix[3];this.m21=matrix[4];this.m22=matrix[5];this.m23=matrix[6];this.m24=matrix[7];this.m31=matrix[8];this.m32=matrix[9];this.m33=matrix[10];this.m34=matrix[11];this.m41=matrix[12];this.m42=matrix[13];this.m43=matrix[14];this.m44=matrix[15];return}if(arguments[0]instanceof CanvasMatrix4){this.m11=matrix.m11;this.m12=matrix.m12;this.m13=matrix.m13;this.m14=matrix.m14;this.m21=matrix.m21;this.m22=matrix.m22;this.m23=matrix.m23;this.m24=matrix.m24;this.m31=matrix.m31;this.m32=matrix.m32;this.m33=matrix.m33;this.m34=matrix.m34;this.m41=matrix.m41;this.m42=matrix.m42;this.m43=matrix.m43;this.m44=matrix.m44;return}}this.makeIdentity()};CanvasMatrix4.prototype.getAsArray=function(){return[this.m11,this.m12,this.m13,this.m14,this.m21,this.m22,this.m23,this.m24,this.m31,this.m32,this.m33,this.m34,this.m41,this.m42,this.m43,this.m44]};CanvasMatrix4.prototype.getAsWebGLFloatArray=function(){return new WebGLFloatArray(this.getAsArray())};CanvasMatrix4.prototype.makeIdentity=function(){this.m11=1;this.m12=0;this.m13=0;this.m14=0;this.m21=0;this.m22=1;this.m23=0;this.m24=0;this.m31=0;this.m32=0;this.m33=1;this.m34=0;this.m41=0;this.m42=0;this.m43=0;this.m44=1};CanvasMatrix4.prototype.transpose=function(){var tmp=this.m12;this.m12=this.m21;this.m21=tmp;tmp=this.m13;this.m13=this.m31;this.m31=tmp;tmp=this.m14;this.m14=this.m41;this.m41=tmp;tmp=this.m23;this.m23=this.m32;this.m32=tmp;tmp=this.m24;this.m24=this.m42;this.m42=tmp;tmp=this.m34;this.m34=this.m43;this.m43=tmp};CanvasMatrix4.prototype.invert=function(){var det=this._determinant4x4();if(Math.abs(det)<1e-8)return null;this._makeAdjoint();this.m11/=det;this.m12/=det;this.m13/=det;this.m14/=det;this.m21/=det;this.m22/=det;this.m23/=det;this.m24/=det;this.m31/=det;this.m32/=det;this.m33/=det;this.m34/=det;this.m41/=det;this.m42/=det;this.m43/=det;this.m44/=det};CanvasMatrix4.prototype.translate=function(x,y,z){if(x==undefined)x=0;if(y==undefined)y=0;if(z==undefined)z=0;var matrix=new CanvasMatrix4();matrix.m41=x;matrix.m42=y;matrix.m43=z;this.multRight(matrix)};CanvasMatrix4.prototype.scale=function(x,y,z){if(x==undefined)x=1;if(z==undefined){if(y==undefined){y=x;z=x}else z=1}else if(y==undefined)y=x;var matrix=new CanvasMatrix4();matrix.m11=x;matrix.m22=y;matrix.m33=z;this.multRight(matrix)};CanvasMatrix4.prototype.rotate=function(angle,x,y,z){angle=angle/180*Math.PI;angle/=2;var sinA=Math.sin(angle);var cosA=Math.cos(angle);var sinA2=sinA*sinA;var length=Math.sqrt(x*x+y*y+z*z);if(length==0){x=0;y=0;z=1}else if(length!=1){x/=length;y/=length;z/=length}var mat=new CanvasMatrix4();if(x==1&&y==0&&z==0){mat.m11=1;mat.m12=0;mat.m13=0;mat.m21=0;mat.m22=1-2*sinA2;mat.m23=2*sinA*cosA;mat.m31=0;mat.m32=-2*sinA*cosA;mat.m33=1-2*sinA2;mat.m14=mat.m24=mat.m34=0;mat.m41=mat.m42=mat.m43=0;mat.m44=1}else if(x==0&&y==1&&z==0){mat.m11=1-2*sinA2;mat.m12=0;mat.m13=-2*sinA*cosA;mat.m21=0;mat.m22=1;mat.m23=0;mat.m31=2*sinA*cosA;mat.m32=0;mat.m33=1-2*sinA2;mat.m14=mat.m24=mat.m34=0;mat.m41=mat.m42=mat.m43=0;mat.m44=1}else if(x==0&&y==0&&z==1){mat.m11=1-2*sinA2;mat.m12=2*sinA*cosA;mat.m13=0;mat.m21=-2*sinA*cosA;mat.m22=1-2*sinA2;mat.m23=0;mat.m31=0;mat.m32=0;mat.m33=1;mat.m14=mat.m24=mat.m34=0;mat.m41=mat.m42=mat.m43=0;mat.m44=1}else{var x2=x*x;var y2=y*y;var z2=z*z;mat.m11=1-2*(y2+z2)*sinA2;mat.m12=2*(x*y*sinA2+z*sinA*cosA);mat.m13=2*(x*z*sinA2-y*sinA*cosA);mat.m21=2*(y*x*sinA2-z*sinA*cosA);mat.m22=1-2*(z2+x2)*sinA2;mat.m23=2*(y*z*sinA2+x*sinA*cosA);mat.m31=2*(z*x*sinA2+y*sinA*cosA);mat.m32=2*(z*y*sinA2-x*sinA*cosA);mat.m33=1-2*(x2+y2)*sinA2;mat.m14=mat.m24=mat.m34=0;mat.m41=mat.m42=mat.m43=0;mat.m44=1}this.multRight(mat)};CanvasMatrix4.prototype.multRight=function(mat){var m11=(this.m11*mat.m11+this.m12*mat.m21+this.m13*mat.m31+this.m14*mat.m41);var m12=(this.m11*mat.m12+this.m12*mat.m22+this.m13*mat.m32+this.m14*mat.m42);var m13=(this.m11*mat.m13+this.m12*mat.m23+this.m13*mat.m33+this.m14*mat.m43);var m14=(this.m11*mat.m14+this.m12*mat.m24+this.m13*mat.m34+this.m14*mat.m44);var m21=(this.m21*mat.m11+this.m22*mat.m21+this.m23*mat.m31+this.m24*mat.m41);var m22=(this.m21*mat.m12+this.m22*mat.m22+this.m23*mat.m32+this.m24*mat.m42);var m23=(this.m21*mat.m13+this.m22*mat.m23+this.m23*mat.m33+this.m24*mat.m43);var m24=(this.m21*mat.m14+this.m22*mat.m24+this.m23*mat.m34+this.m24*mat.m44);var m31=(this.m31*mat.m11+this.m32*mat.m21+this.m33*mat.m31+this.m34*mat.m41);var m32=(this.m31*mat.m12+this.m32*mat.m22+this.m33*mat.m32+this.m34*mat.m42);var m33=(this.m31*mat.m13+this.m32*mat.m23+this.m33*mat.m33+this.m34*mat.m43);var m34=(this.m31*mat.m14+this.m32*mat.m24+this.m33*mat.m34+this.m34*mat.m44);var m41=(this.m41*mat.m11+this.m42*mat.m21+this.m43*mat.m31+this.m44*mat.m41);var m42=(this.m41*mat.m12+this.m42*mat.m22+this.m43*mat.m32+this.m44*mat.m42);var m43=(this.m41*mat.m13+this.m42*mat.m23+this.m43*mat.m33+this.m44*mat.m43);var m44=(this.m41*mat.m14+this.m42*mat.m24+this.m43*mat.m34+this.m44*mat.m44);this.m11=m11;this.m12=m12;this.m13=m13;this.m14=m14;this.m21=m21;this.m22=m22;this.m23=m23;this.m24=m24;this.m31=m31;this.m32=m32;this.m33=m33;this.m34=m34;this.m41=m41;this.m42=m42;this.m43=m43;this.m44=m44};CanvasMatrix4.prototype.multLeft=function(mat){var m11=(mat.m11*this.m11+mat.m12*this.m21+mat.m13*this.m31+mat.m14*this.m41);var m12=(mat.m11*this.m12+mat.m12*this.m22+mat.m13*this.m32+mat.m14*this.m42);var m13=(mat.m11*this.m13+mat.m12*this.m23+mat.m13*this.m33+mat.m14*this.m43);var m14=(mat.m11*this.m14+mat.m12*this.m24+mat.m13*this.m34+mat.m14*this.m44);var m21=(mat.m21*this.m11+mat.m22*this.m21+mat.m23*this.m31+mat.m24*this.m41);var m22=(mat.m21*this.m12+mat.m22*this.m22+mat.m23*this.m32+mat.m24*this.m42);var m23=(mat.m21*this.m13+mat.m22*this.m23+mat.m23*this.m33+mat.m24*this.m43);var m24=(mat.m21*this.m14+mat.m22*this.m24+mat.m23*this.m34+mat.m24*this.m44);var m31=(mat.m31*this.m11+mat.m32*this.m21+mat.m33*this.m31+mat.m34*this.m41);var m32=(mat.m31*this.m12+mat.m32*this.m22+mat.m33*this.m32+mat.m34*this.m42);var m33=(mat.m31*this.m13+mat.m32*this.m23+mat.m33*this.m33+mat.m34*this.m43);var m34=(mat.m31*this.m14+mat.m32*this.m24+mat.m33*this.m34+mat.m34*this.m44);var m41=(mat.m41*this.m11+mat.m42*this.m21+mat.m43*this.m31+mat.m44*this.m41);var m42=(mat.m41*this.m12+mat.m42*this.m22+mat.m43*this.m32+mat.m44*this.m42);var m43=(mat.m41*this.m13+mat.m42*this.m23+mat.m43*this.m33+mat.m44*this.m43);var m44=(mat.m41*this.m14+mat.m42*this.m24+mat.m43*this.m34+mat.m44*this.m44);this.m11=m11;this.m12=m12;this.m13=m13;this.m14=m14;this.m21=m21;this.m22=m22;this.m23=m23;this.m24=m24;this.m31=m31;this.m32=m32;this.m33=m33;this.m34=m34;this.m41=m41;this.m42=m42;this.m43=m43;this.m44=m44};CanvasMatrix4.prototype.ortho=function(left,right,bottom,top,near,far){var tx=(left+right)/(left-right);var ty=(top+bottom)/(top-bottom);var tz=(far+near)/(far-near);var matrix=new CanvasMatrix4();matrix.m11=2/(left-right);matrix.m12=0;matrix.m13=0;matrix.m14=0;matrix.m21=0;matrix.m22=2/(top-bottom);matrix.m23=0;matrix.m24=0;matrix.m31=0;matrix.m32=0;matrix.m33=-2/(far-near);matrix.m34=0;matrix.m41=tx;matrix.m42=ty;matrix.m43=tz;matrix.m44=1;this.multRight(matrix)};CanvasMatrix4.prototype.frustum=function(left,right,bottom,top,near,far){var matrix=new CanvasMatrix4();var A=(right+left)/(right-left);var B=(top+bottom)/(top-bottom);var C=-(far+near)/(far-near);var D=-(2*far*near)/(far-near);matrix.m11=(2*near)/(right-left);matrix.m12=0;matrix.m13=0;matrix.m14=0;matrix.m21=0;matrix.m22=2*near/(top-bottom);matrix.m23=0;matrix.m24=0;matrix.m31=A;matrix.m32=B;matrix.m33=C;matrix.m34=-1;matrix.m41=0;matrix.m42=0;matrix.m43=D;matrix.m44=0;this.multRight(matrix)};CanvasMatrix4.prototype.perspective=function(fovy,aspect,zNear,zFar){var top=Math.tan(fovy*Math.PI/360)*zNear;var bottom=-top;var left=aspect*bottom;var right=aspect*top;this.frustum(left,right,bottom,top,zNear,zFar)};CanvasMatrix4.prototype.lookat=function(eyex,eyey,eyez,centerx,centery,centerz,upx,upy,upz){var matrix=new CanvasMatrix4();var zx=eyex-centerx;var zy=eyey-centery;var zz=eyez-centerz;var mag=Math.sqrt(zx*zx+zy*zy+zz*zz);if(mag){zx/=mag;zy/=mag;zz/=mag}var yx=upx;var yy=upy;var yz=upz;xx=yy*zz-yz*zy;xy=-yx*zz+yz*zx;xz=yx*zy-yy*zx;yx=zy*xz-zz*xy;yy=-zx*xz+zz*xx;yx=zx*xy-zy*xx;mag=Math.sqrt(xx*xx+xy*xy+xz*xz);if(mag){xx/=mag;xy/=mag;xz/=mag}mag=Math.sqrt(yx*yx+yy*yy+yz*yz);if(mag){yx/=mag;yy/=mag;yz/=mag}matrix.m11=xx;matrix.m12=xy;matrix.m13=xz;matrix.m14=0;matrix.m21=yx;matrix.m22=yy;matrix.m23=yz;matrix.m24=0;matrix.m31=zx;matrix.m32=zy;matrix.m33=zz;matrix.m34=0;matrix.m41=0;matrix.m42=0;matrix.m43=0;matrix.m44=1;matrix.translate(-eyex,-eyey,-eyez);this.multRight(matrix)};CanvasMatrix4.prototype._determinant2x2=function(a,b,c,d){return a*d-b*c};CanvasMatrix4.prototype._determinant3x3=function(a1,a2,a3,b1,b2,b3,c1,c2,c3){return a1*this._determinant2x2(b2,b3,c2,c3)-b1*this._determinant2x2(a2,a3,c2,c3)+c1*this._determinant2x2(a2,a3,b2,b3)};CanvasMatrix4.prototype._determinant4x4=function(){var a1=this.m11;var b1=this.m12;var c1=this.m13;var d1=this.m14;var a2=this.m21;var b2=this.m22;var c2=this.m23;var d2=this.m24;var a3=this.m31;var b3=this.m32;var c3=this.m33;var d3=this.m34;var a4=this.m41;var b4=this.m42;var c4=this.m43;var d4=this.m44;return a1*this._determinant3x3(b2,b3,b4,c2,c3,c4,d2,d3,d4)-b1*this._determinant3x3(a2,a3,a4,c2,c3,c4,d2,d3,d4)+c1*this._determinant3x3(a2,a3,a4,b2,b3,b4,d2,d3,d4)-d1*this._determinant3x3(a2,a3,a4,b2,b3,b4,c2,c3,c4)};CanvasMatrix4.prototype._makeAdjoint=function(){var a1=this.m11;var b1=this.m12;var c1=this.m13;var d1=this.m14;var a2=this.m21;var b2=this.m22;var c2=this.m23;var d2=this.m24;var a3=this.m31;var b3=this.m32;var c3=this.m33;var d3=this.m34;var a4=this.m41;var b4=this.m42;var c4=this.m43;var d4=this.m44;this.m11=this._determinant3x3(b2,b3,b4,c2,c3,c4,d2,d3,d4);this.m21=-this._determinant3x3(a2,a3,a4,c2,c3,c4,d2,d3,d4);this.m31=this._determinant3x3(a2,a3,a4,b2,b3,b4,d2,d3,d4);this.m41=-this._determinant3x3(a2,a3,a4,b2,b3,b4,c2,c3,c4);this.m12=-this._determinant3x3(b1,b3,b4,c1,c3,c4,d1,d3,d4);this.m22=this._determinant3x3(a1,a3,a4,c1,c3,c4,d1,d3,d4);this.m32=-this._determinant3x3(a1,a3,a4,b1,b3,b4,d1,d3,d4);this.m42=this._determinant3x3(a1,a3,a4,b1,b3,b4,c1,c3,c4);this.m13=this._determinant3x3(b1,b2,b4,c1,c2,c4,d1,d2,d4);this.m23=-this._determinant3x3(a1,a2,a4,c1,c2,c4,d1,d2,d4);this.m33=this._determinant3x3(a1,a2,a4,b1,b2,b4,d1,d2,d4);this.m43=-this._determinant3x3(a1,a2,a4,b1,b2,b4,c1,c2,c4);this.m14=-this._determinant3x3(b1,b2,b3,c1,c2,c3,d1,d2,d3);this.m24=this._determinant3x3(a1,a2,a3,c1,c2,c3,d1,d2,d3);this.m34=-this._determinant3x3(a1,a2,a3,b1,b2,b3,d1,d2,d3);this.m44=this._determinant3x3(a1,a2,a3,b1,b2,b3,c1,c2,c3)}
</script>

--- &vcenter

<img src="assets/img/1000genome.jpg" style="margin:0px auto;display:block" width="900">

---

## Why do I do it?
> * Started as a postdoc in Jo Handelsman's lab   
> * I have the ability to code and translate that ability to biologists - if we can develop the tools then surely others will benefit  
> * I don't like how others benchmark/validate methods
> * My lab needs software to analyze data and the tools are either poorly developed/tested or not available  

--- &vcenter

<img src="assets/img/mothurtitlepage.jpg" style="margin:0px auto;display:block" width="900">

--- &twocol
## Extensive resources

*** {name: left}
* [splash page](http://www.mothur.org)
* [github repository](https://github.com/mothur/mothur)
* [analysis examples](http://www.mothur.org/wiki/Analysis_examples)
* [wiki](http://www.mothur.org/wiki)
* [forum](http://www.mothur.org/forum)
* [blog](http://blog.mothur.org)
* [mailing list](http://www.mothur.org/mailman/listinfo/mothur-announce)
* [twitter](https://twitter.com/PatSchloss)  
* [videoblog](https://www.youtube.com/user/mothurvideoblog)
* [facebook](http://www.facebook.com/mothur)

*** {name: right}
<img src="assets/img/sjmothur.jpg" style="margin:0px auto;display:block", width=500>

--- 
 
## Who is the typical end user? 
* Not programmers 
    * 40% have no programming background 
    * 33% know Perl 
    * 35% know R 
    * 10-20% know C/C++, Java, Python, SQL, or shell 
* Probably uncomfortable with shell
    * 48% Windows
    * 33% Mac OSX
    * 45% Linux

--- 
 
## Think of yourself, your students, or your physician...
> * How do we react to foreign jargon?
    * Cloud? 
    * Version control? 
    * Dependencies? 
    * JSON/HDFS/LNPR? 
> * Our goal is to meet the users where they are and bring them up. Not to make them feel dumb.
    * GUI
    * Examples and documentation
    * Forum
    * Workshops

--- 

## What we developed
* Stand-alone, platform-independent, open source, community supported (-ive) software package
* Builds upon popularity of DOTUR, which was published in 2005 (1473 citations; as of 8/13/14)
* The design is very PAUP*/R-ish
* We want to serve the people in coach, not the cockpit

--- &twocol 

## What does this look like?
*** {name: left}
* **Obvious** (e.g. Venn diagrams, de-convolution, heat maps)
* **De novo** (e.g. sequence trimming and filtering)
* **Derivative** (e.g. cluster, rarefaction curves, PCoA)
* **Ports of original source code** (e.g. UClust, Clearcut, CatchAll)
* **Some we re-write** (e.g. aligner, classifier, metastats, etc.)

*** {name: right}
* **Make open source** (e.g. aligner, ESPRIT)
* **Make more flexible** (e.g. classifier)
* **Add features** (e.g. ESPRIT, ChimeraSlayer)
* **Make platform independent** (e.g. sffinfo, AmpliconNoise)
* **Improve engineering** (e.g. aligner, PyroNoise)
* **Helps us to understand how things work**

--- 

## Pro/cons of strategy
* Will not serve "power users" - but they don't need us anyway
* Not always the same implementation
    * We do screw up on occasion
    * We can make things better and more accessible
* Too many options
    * This can be confusing
    *  Allow people to make bad choices

--- 

## How are we doing?

<img src="assets/img/citationcount.jpg" style="margin:0px auto;display:block" width="950">

**AltMetrics:**
* 2952 mailing list recipients
* 313 wiki articles
* 915 forum members
* 7486 forum posts for 2252 topics

--- .segue .dark

## Sequencing on the MiSeq

--- 
## Preliminaries
* Platforms
    * HiSeq/GAII - tons of paired 150 nt reads (goodluck!)
    * MiSeq - 12-15x10\^6 250PE reads or 22-25x10\^6 300PE reads
* Low complexity 
    * Requires 5-10% PhiX spike in
    * Low cluster density
    * No need for staggered primers
* Need high quality data since we cannot resequence the same base more than twice

--- 

## Various approaches to sequencing 16S rRNA genes
> * Single read sequencing
> * Sequence through primer and index (Illumina's protocol)
    * Waste base calls
    * Requires two PCR steps to get adapters on (chimeras?)
> * Caporasso (EMP/AG/etc.)
    * Single index - large number of long primers
    * Generally being used with HiSeq (?)
> * Kozich/Schloss
    * Dual index - considerably fewer primers required
    * [Wet-lab SOP](http://www.mothur.org/w/images/0/0c/Wet-lab_MiSeq_SOP.pdf) available
*** =pnotes
To sequence 384 samples...
* By Caporasso you would need 384 + 1 primers
* By Kozich you would need 24 + 16 = 40 primers

---

## Which factors to consider before choosing a method?
> 1. Data quality
> 1. Number of reads
> 1. Sequence length
> 1. Cost  

---

## Importance of error rates
* Traditional genomics approach builds contigs and so errors are “solved” by increased coverage
* This is not possible for 16S rRNA sequencing
    * The sequencer can artificially generate biodiversity
    * Would like to have as fine-scale a resolution as possible
    * Additional unique sequences makes data curation/processing more challenging

--- 

## Questions
* Does a dual-index strategy work?
* Can we create a pipeline like we have for 454 that results in low error rate data?
* Is it possible to move beyond the Knight approach now that reads have gone from 150 to 250  to 300 bp to sequence longer regions?
* What are the principles of primer design so we can amplify other regions and genes?

--- bg:#FFFFFF
<img src="assets/img/primerlayout.jpg" width=950, style="margin:0px auto;display:block">

---  
## Dual indexing makes things easier

| # Samples | #F Primers | #R Primers | Reads/Sample*                   |
|:---------:|:----------:|:----------:|:------------------------------:|
| 96        | 12         | 8          | 156250  |
| 192       | 12         | 16         | 78125 |
| 384       | 24         | 16         | 39062 |
| 1536      | 48         | 32         | 9766|

# **\* assumes:** 15x10^6 reads per run

--- &vcenter 
## Overlapping regions within the 16S rRNA gene

<img src="assets/img/regionlayout.jpg">

--- 
## Experimental design
* Amplified V34, V4, and V45 from mock community DNA and DNA isolated from human feces, mouse feces, and soil
* All samples amplified in triplicate with different barcodes (12 total samples)
* Have used same design/samples with other sequencing platforms (454, PacBio, IonTorrent)

--- 
## Mock community
* DNA from 21 bacterial isolates with genome sequences:  
     *Acinetobacter baumannii, Actinomyces odontolyticus, Bacillus cereus, Bacteroides vulgatus, Clostridium beijerinckii, Deinococcus radiodurans, Enterococcus faecalis, Escherichia coli, Helicobacter pylori, Lactobacillus gasseri, Listeria monocytogenes, Neisseria meningitidis, Porphyromonas gingivalis, Propionibacterium acnes, Pseudomonas aeruginosa, Rhodobacter sphaeroides, Staphylococcus aureus, Staphylococcus epidermidis, Streptococcus agalactiae, Streptococcus mutans, Streptococcus pneumoniae* (Available through BEI: v3.1, HM-278D)
* Since we know the true 16S rRNA gene sequences we can measure the error rates
* Can remove chimeras *a priori*

--- 

## Basic error correction
* Trust MiSeq software to call indices
* Form contigs between read pairs and resolve mismatch based on better quality score (same score = N)
* Remove anything with…
    * Ambiguous base calls
    * Homopolymer length greater than 8
    * Doesn’t map to correct region

---

## Error profile

<img src="assets/img/errorprofile.pdf" width="900">


---

## Make contigs
* Align forward and reverse reads to each other along with their quality scores
* If there is a mismatch the base a qual score that is greater than or equal to DQthreshold wins
* If it is less than DQthreshold the base becomes an N and the read will ultimately get rejected
* Contig length must make “sense”

---
## Error rates  

<img src="assets/img/errorrates.pdf" style="margin:0px auto;display:block" width="750">  
* The V4 region yields the best error rates and retains the most reads  
* Require Q to be at least 6 points higher to break a mismatch  

--- 

## Error rate summary

| Region  | Length | Error rate after making contigs (%) | Error rate after pre.cluster (%) |
|---------|--------|-------------------------------------|----------------------------------|
| V3-V4   | 429    | 0.41                                | 0.26                             |
| V4      | 253    | 0.04                                | 0.01                             |
| V4-V5   | 375    | 0.57                                | 0.26                             |
| "V3-V5" | 260    | 0.06                                | 0.02                             

# **"V3-V5":** Based on our 454 SOP using PyroNoise

--- 

## Richness
| Sample        | V3-V4          | V4            | V4-V5            |
|---------------|----------------|---------------|------------------|
| Mock - PC(20) | NA             | 21.4          | 83.5             |
| Mock - actual | NA             | 32.4          | 126.2            |
| Mouse         | NA             | 135.7         | 145.7            |
| Human         | NA             | 121.6         | 187.8            |
| Soil          | NA             | 1271.3        | 1221.2           |
  
# All rarefied to 5,000 reads
# (XX) – number of OTUs w/ no errors
# Mock-PC has no chimeras
  
* "Richness" is correlated with sequencing depth / crap
* Error rates have a significant impact on number of observed OTUs

---

## Error rate with new chemsitry

| Region  | Length | 250PE error rate after making contigs (%) | 300PE error rate after pre.cluster (%) |
|---------|--------|-------------------------------------------|----------------------------------------|
| V3-V4   | 429    | 0.41                                      | 0.80                                   |
| V4      | 253    | 0.04                                      | 0.04                                   |
| V4-V5   | 375    | 0.57                                      | 0.90                                   |
| "V3-V5" | 260    | 0.06                                      | NA                                     |     

# **"V3-V5":** Based on our 454 SOP using PyroNoise
   

### Meh.

---

## Quality scores with the V3 chemistry

<img src="assets/img/qscores.jpg" style="margin:0px auto;display:block" width="900">

### Note that the quality scores crap out around cycle 500

---

## Concluding the MiSeq pipeline
* Sequence reads must fully overlap with each other to get good error remediation
* If they don't...
    * Inflated number of unique reads / OTUs
    * Samples will look more different than they really are
    * Significant computational hurdles await
    * Cheaper to throw data away and resquence correctly than to buy sufficient RAM/time
* The V3 MiSeq kit isn't going to cut it for longer reads

--- .segue .dark

## The rest of the pipeline

---

## The [MiSeq mothur SOP](http://www.mothur.org/wiki/MiSeq_SOP)
| method         | what it does... | reference    |
|----------------|-----------------|--------------|
| `make.contigs` | assemble reads  | [Kozich et al. 2014](http://www.ncbi.nlm.nih.gov/pubmed/23793624)
| `screen.seqs` | remove bad reads |
| `unique.seqs` | collapse duplicate reads |
| `count.seqs` | count frequency of each sequence in each sample |
| `align.seqs` | align sequences to a reference | [Schloss 2009](http://www.ncbi.nlm.nih.gov/pubmed/20011594), [Schloss 2010](http://www.ncbi.nlm.nih.gov/pubmed/20628621)
| `filter.seqs` | trim reads to same alignment space | [Schloss 2013](http://www.ncbi.nlm.nih.gov/pubmed/23018771)
| `pre.cluster` | remove one and two offs | [Schloss et al. 2011](http://www.ncbi.nlm.nih.gov/pubmed/22194782)
| `chimera.uchime` | identify and remove chimeras | [Edgar et al. 2011](http://www.ncbi.nlm.nih.gov/pubmed/21700674)
| `classify.seqs` | classify sequences against a database | [Wang et al. 2009](http://www.ncbi.nlm.nih.gov/pubmed/17586664)
| `remove.lineage` | remove contaminants | 
| `cluster.split` | assign sequences to OTUs | [Schloss & Westcott 2011](http://www.ncbi.nlm.nih.gov/pubmed/21421784)
| `phylotype` | assign sequences to phylotypes | 
| `make.shared` | generate sample by OTU frequency table | 
| `clearcut` | generate a neighbor-joining tree | [Sheneman et al. 2006](http://www.ncbi.nlm.nih.gov/pubmed/16982706)

--- &twocol w1:35% w2:55%
## Philosophy
*** {name: left}
* mothur is one tool you have for analyzing your 16S rRNA gene sequences
* We cannot envision or accomodate every analysis need that every researcher has
* You need to take the next step of learning R or python to make your analysis unique

*** {name: right}

<canvas id="unnamed_chunk_1textureCanvas" style="display: none;" width="256" height="256">
Your browser does not support the HTML5 canvas element.</canvas>
<!-- ****** spheres object 6 ****** -->
<script id="unnamed_chunk_1vshader6" type="x-shader/x-vertex">
attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;
attribute vec3 aNorm;
uniform mat4 normMatrix;
varying vec3 vNormal;
void main(void) {
vPosition = mvMatrix * vec4(aPos, 1.);
gl_Position = prMatrix * vPosition;
vCol = aCol;
vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);
}
</script>
<script id="unnamed_chunk_1fshader6" type="x-shader/x-fragment"> 
#ifdef GL_ES
precision highp float;
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
varying vec3 vNormal;
void main(void) {
vec3 eye = normalize(-vPosition.xyz);
const vec3 emission = vec3(0., 0., 0.);
const vec3 ambient1 = vec3(0., 0., 0.);
const vec3 specular1 = vec3(1., 1., 1.);// light*material
const float shininess1 = 50.;
vec4 colDiff1 = vec4(vCol.rgb * vec3(1., 1., 1.), vCol.a);
const vec3 lightDir1 = vec3(0., 0., 1.);
vec3 halfVec1 = normalize(lightDir1 + eye);
vec4 lighteffect = vec4(emission, 0.);
vec3 n = normalize(vNormal);
n = -faceforward(n, n, eye);
vec3 col1 = ambient1;
float nDotL1 = dot(n, lightDir1);
col1 = col1 + max(nDotL1, 0.) * colDiff1.rgb;
col1 = col1 + pow(max(dot(halfVec1, n), 0.), shininess1) * specular1;
lighteffect = lighteffect + vec4(col1, colDiff1.a);
gl_FragColor = lighteffect;
}
</script> 
<!-- ****** text object 8 ****** -->
<script id="unnamed_chunk_1vshader8" type="x-shader/x-vertex">
attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;
attribute vec2 aTexcoord;
varying vec2 vTexcoord;
attribute vec2 aOfs;
void main(void) {
vCol = aCol;
vTexcoord = aTexcoord;
vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);
pos = pos/pos.w;
gl_Position = pos + vec4(aOfs, 0.,0.);
}
</script>
<script id="unnamed_chunk_1fshader8" type="x-shader/x-fragment"> 
#ifdef GL_ES
precision highp float;
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
varying vec2 vTexcoord;
uniform sampler2D uSampler;
void main(void) {
vec4 colDiff = vCol;
vec4 lighteffect = colDiff;
vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
if (textureColor.a < 0.1)
discard;
else
gl_FragColor = textureColor;
}
</script> 
<!-- ****** text object 9 ****** -->
<script id="unnamed_chunk_1vshader9" type="x-shader/x-vertex">
attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;
attribute vec2 aTexcoord;
varying vec2 vTexcoord;
attribute vec2 aOfs;
void main(void) {
vCol = aCol;
vTexcoord = aTexcoord;
vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);
pos = pos/pos.w;
gl_Position = pos + vec4(aOfs, 0.,0.);
}
</script>
<script id="unnamed_chunk_1fshader9" type="x-shader/x-fragment"> 
#ifdef GL_ES
precision highp float;
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
varying vec2 vTexcoord;
uniform sampler2D uSampler;
void main(void) {
vec4 colDiff = vCol;
vec4 lighteffect = colDiff;
vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
if (textureColor.a < 0.1)
discard;
else
gl_FragColor = textureColor;
}
</script> 
<!-- ****** text object 10 ****** -->
<script id="unnamed_chunk_1vshader10" type="x-shader/x-vertex">
attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;
attribute vec2 aTexcoord;
varying vec2 vTexcoord;
attribute vec2 aOfs;
void main(void) {
vCol = aCol;
vTexcoord = aTexcoord;
vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);
pos = pos/pos.w;
gl_Position = pos + vec4(aOfs, 0.,0.);
}
</script>
<script id="unnamed_chunk_1fshader10" type="x-shader/x-fragment"> 
#ifdef GL_ES
precision highp float;
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
varying vec2 vTexcoord;
uniform sampler2D uSampler;
void main(void) {
vec4 colDiff = vCol;
vec4 lighteffect = colDiff;
vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
if (textureColor.a < 0.1)
discard;
else
gl_FragColor = textureColor;
}
</script> 
<!-- ****** lines object 11 ****** -->
<script id="unnamed_chunk_1vshader11" type="x-shader/x-vertex">
attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;
void main(void) {
vPosition = mvMatrix * vec4(aPos, 1.);
gl_Position = prMatrix * vPosition;
vCol = aCol;
}
</script>
<script id="unnamed_chunk_1fshader11" type="x-shader/x-fragment"> 
#ifdef GL_ES
precision highp float;
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
void main(void) {
vec4 colDiff = vCol;
vec4 lighteffect = colDiff;
gl_FragColor = lighteffect;
}
</script> 
<!-- ****** text object 12 ****** -->
<script id="unnamed_chunk_1vshader12" type="x-shader/x-vertex">
attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;
attribute vec2 aTexcoord;
varying vec2 vTexcoord;
attribute vec2 aOfs;
void main(void) {
vCol = aCol;
vTexcoord = aTexcoord;
vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);
pos = pos/pos.w;
gl_Position = pos + vec4(aOfs, 0.,0.);
}
</script>
<script id="unnamed_chunk_1fshader12" type="x-shader/x-fragment"> 
#ifdef GL_ES
precision highp float;
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
varying vec2 vTexcoord;
uniform sampler2D uSampler;
void main(void) {
vec4 colDiff = vCol;
vec4 lighteffect = colDiff;
vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
if (textureColor.a < 0.1)
discard;
else
gl_FragColor = textureColor;
}
</script> 
<!-- ****** lines object 13 ****** -->
<script id="unnamed_chunk_1vshader13" type="x-shader/x-vertex">
attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;
void main(void) {
vPosition = mvMatrix * vec4(aPos, 1.);
gl_Position = prMatrix * vPosition;
vCol = aCol;
}
</script>
<script id="unnamed_chunk_1fshader13" type="x-shader/x-fragment"> 
#ifdef GL_ES
precision highp float;
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
void main(void) {
vec4 colDiff = vCol;
vec4 lighteffect = colDiff;
gl_FragColor = lighteffect;
}
</script> 
<!-- ****** text object 14 ****** -->
<script id="unnamed_chunk_1vshader14" type="x-shader/x-vertex">
attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;
attribute vec2 aTexcoord;
varying vec2 vTexcoord;
attribute vec2 aOfs;
void main(void) {
vCol = aCol;
vTexcoord = aTexcoord;
vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);
pos = pos/pos.w;
gl_Position = pos + vec4(aOfs, 0.,0.);
}
</script>
<script id="unnamed_chunk_1fshader14" type="x-shader/x-fragment"> 
#ifdef GL_ES
precision highp float;
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
varying vec2 vTexcoord;
uniform sampler2D uSampler;
void main(void) {
vec4 colDiff = vCol;
vec4 lighteffect = colDiff;
vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
if (textureColor.a < 0.1)
discard;
else
gl_FragColor = textureColor;
}
</script> 
<!-- ****** lines object 15 ****** -->
<script id="unnamed_chunk_1vshader15" type="x-shader/x-vertex">
attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;
void main(void) {
vPosition = mvMatrix * vec4(aPos, 1.);
gl_Position = prMatrix * vPosition;
vCol = aCol;
}
</script>
<script id="unnamed_chunk_1fshader15" type="x-shader/x-fragment"> 
#ifdef GL_ES
precision highp float;
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
void main(void) {
vec4 colDiff = vCol;
vec4 lighteffect = colDiff;
gl_FragColor = lighteffect;
}
</script> 
<!-- ****** text object 16 ****** -->
<script id="unnamed_chunk_1vshader16" type="x-shader/x-vertex">
attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;
attribute vec2 aTexcoord;
varying vec2 vTexcoord;
attribute vec2 aOfs;
void main(void) {
vCol = aCol;
vTexcoord = aTexcoord;
vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);
pos = pos/pos.w;
gl_Position = pos + vec4(aOfs, 0.,0.);
}
</script>
<script id="unnamed_chunk_1fshader16" type="x-shader/x-fragment"> 
#ifdef GL_ES
precision highp float;
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
varying vec2 vTexcoord;
uniform sampler2D uSampler;
void main(void) {
vec4 colDiff = vCol;
vec4 lighteffect = colDiff;
vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
if (textureColor.a < 0.1)
discard;
else
gl_FragColor = textureColor;
}
</script> 
<!-- ****** lines object 17 ****** -->
<script id="unnamed_chunk_1vshader17" type="x-shader/x-vertex">
attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;
void main(void) {
vPosition = mvMatrix * vec4(aPos, 1.);
gl_Position = prMatrix * vPosition;
vCol = aCol;
}
</script>
<script id="unnamed_chunk_1fshader17" type="x-shader/x-fragment"> 
#ifdef GL_ES
precision highp float;
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
void main(void) {
vec4 colDiff = vCol;
vec4 lighteffect = colDiff;
gl_FragColor = lighteffect;
}
</script> 
<script type="text/javascript"> 
function getShader ( gl, id ){
var shaderScript = document.getElementById ( id );
var str = "";
var k = shaderScript.firstChild;
while ( k ){
if ( k.nodeType == 3 ) str += k.textContent;
k = k.nextSibling;
}
var shader;
if ( shaderScript.type == "x-shader/x-fragment" )
shader = gl.createShader ( gl.FRAGMENT_SHADER );
else if ( shaderScript.type == "x-shader/x-vertex" )
shader = gl.createShader(gl.VERTEX_SHADER);
else return null;
gl.shaderSource(shader, str);
gl.compileShader(shader);
if (gl.getShaderParameter(shader, gl.COMPILE_STATUS) == 0)
alert(gl.getShaderInfoLog(shader));
return shader;
}
var min = Math.min;
var max = Math.max;
var sqrt = Math.sqrt;
var sin = Math.sin;
var acos = Math.acos;
var tan = Math.tan;
var SQRT2 = Math.SQRT2;
var PI = Math.PI;
var log = Math.log;
var exp = Math.exp;
function unnamed_chunk_1webGLStart() {
var debug = function(msg) {
document.getElementById("unnamed_chunk_1debug").innerHTML = msg;
}
debug("");
var canvas = document.getElementById("unnamed_chunk_1canvas");
if (!window.WebGLRenderingContext){
debug(" Your browser does not support WebGL. See <a href=\"http://get.webgl.org\">http://get.webgl.org</a>");
return;
}
var gl;
try {
// Try to grab the standard context. If it fails, fallback to experimental.
gl = canvas.getContext("webgl") 
|| canvas.getContext("experimental-webgl");
}
catch(e) {}
if ( !gl ) {
debug(" Your browser appears to support WebGL, but did not create a WebGL context.  See <a href=\"http://get.webgl.org\">http://get.webgl.org</a>");
return;
}
var width = 505;  var height = 505;
canvas.width = width;   canvas.height = height;
gl.viewport(0, 0, width, height);
var prMatrix = new CanvasMatrix4();
var mvMatrix = new CanvasMatrix4();
var normMatrix = new CanvasMatrix4();
var saveMat = new CanvasMatrix4();
saveMat.makeIdentity();
var distance;
var posLoc = 0;
var colLoc = 1;
var zoom = 1;
var fov = 30;
var userMatrix = new CanvasMatrix4();
userMatrix.load([
1, 0, 0, 0,
0, 0.3420201, -0.9396926, 0,
0, 0.9396926, 0.3420201, 0,
0, 0, 0, 1
]);
function getPowerOfTwo(value) {
var pow = 1;
while(pow<value) {
pow *= 2;
}
return pow;
}
function handleLoadedTexture(texture, textureCanvas) {
gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);
gl.bindTexture(gl.TEXTURE_2D, texture);
gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);
gl.generateMipmap(gl.TEXTURE_2D);
gl.bindTexture(gl.TEXTURE_2D, null);
}
function loadImageToTexture(filename, texture) {   
var canvas = document.getElementById("unnamed_chunk_1textureCanvas");
var ctx = canvas.getContext("2d");
var image = new Image();
image.onload = function() {
var w = image.width;
var h = image.height;
var canvasX = getPowerOfTwo(w);
var canvasY = getPowerOfTwo(h);
canvas.width = canvasX;
canvas.height = canvasY;
ctx.imageSmoothingEnabled = true;
ctx.drawImage(image, 0, 0, canvasX, canvasY);
handleLoadedTexture(texture, canvas);
drawScene();
}
image.src = filename;
}  	   
function drawTextToCanvas(text, cex) {
var canvasX, canvasY;
var textX, textY;
var textHeight = 20 * cex;
var textColour = "white";
var fontFamily = "Arial";
var backgroundColour = "rgba(0,0,0,0)";
var canvas = document.getElementById("unnamed_chunk_1textureCanvas");
var ctx = canvas.getContext("2d");
ctx.font = textHeight+"px "+fontFamily;
canvasX = 1;
var widths = [];
for (var i = 0; i < text.length; i++)  {
widths[i] = ctx.measureText(text[i]).width;
canvasX = (widths[i] > canvasX) ? widths[i] : canvasX;
}	  
canvasX = getPowerOfTwo(canvasX);
var offset = 2*textHeight; // offset to first baseline
var skip = 2*textHeight;   // skip between baselines	  
canvasY = getPowerOfTwo(offset + text.length*skip);
canvas.width = canvasX;
canvas.height = canvasY;
ctx.fillStyle = backgroundColour;
ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);
ctx.fillStyle = textColour;
ctx.textAlign = "left";
ctx.textBaseline = "alphabetic";
ctx.font = textHeight+"px "+fontFamily;
for(var i = 0; i < text.length; i++) {
textY = i*skip + offset;
ctx.fillText(text[i], 0,  textY);
}
return {canvasX:canvasX, canvasY:canvasY,
widths:widths, textHeight:textHeight,
offset:offset, skip:skip};
}
// ****** sphere object ******
var v=new Float32Array([
-1, 0, 0,
1, 0, 0,
0, -1, 0,
0, 1, 0,
0, 0, -1,
0, 0, 1,
-0.7071068, 0, -0.7071068,
-0.7071068, -0.7071068, 0,
0, -0.7071068, -0.7071068,
-0.7071068, 0, 0.7071068,
0, -0.7071068, 0.7071068,
-0.7071068, 0.7071068, 0,
0, 0.7071068, -0.7071068,
0, 0.7071068, 0.7071068,
0.7071068, -0.7071068, 0,
0.7071068, 0, -0.7071068,
0.7071068, 0, 0.7071068,
0.7071068, 0.7071068, 0,
-0.9349975, 0, -0.3546542,
-0.9349975, -0.3546542, 0,
-0.77044, -0.4507894, -0.4507894,
0, -0.3546542, -0.9349975,
-0.3546542, 0, -0.9349975,
-0.4507894, -0.4507894, -0.77044,
-0.3546542, -0.9349975, 0,
0, -0.9349975, -0.3546542,
-0.4507894, -0.77044, -0.4507894,
-0.9349975, 0, 0.3546542,
-0.77044, -0.4507894, 0.4507894,
0, -0.9349975, 0.3546542,
-0.4507894, -0.77044, 0.4507894,
-0.3546542, 0, 0.9349975,
0, -0.3546542, 0.9349975,
-0.4507894, -0.4507894, 0.77044,
-0.9349975, 0.3546542, 0,
-0.77044, 0.4507894, -0.4507894,
0, 0.9349975, -0.3546542,
-0.3546542, 0.9349975, 0,
-0.4507894, 0.77044, -0.4507894,
0, 0.3546542, -0.9349975,
-0.4507894, 0.4507894, -0.77044,
-0.77044, 0.4507894, 0.4507894,
0, 0.3546542, 0.9349975,
-0.4507894, 0.4507894, 0.77044,
0, 0.9349975, 0.3546542,
-0.4507894, 0.77044, 0.4507894,
0.9349975, -0.3546542, 0,
0.9349975, 0, -0.3546542,
0.77044, -0.4507894, -0.4507894,
0.3546542, -0.9349975, 0,
0.4507894, -0.77044, -0.4507894,
0.3546542, 0, -0.9349975,
0.4507894, -0.4507894, -0.77044,
0.9349975, 0, 0.3546542,
0.77044, -0.4507894, 0.4507894,
0.3546542, 0, 0.9349975,
0.4507894, -0.4507894, 0.77044,
0.4507894, -0.77044, 0.4507894,
0.9349975, 0.3546542, 0,
0.77044, 0.4507894, -0.4507894,
0.4507894, 0.4507894, -0.77044,
0.3546542, 0.9349975, 0,
0.4507894, 0.77044, -0.4507894,
0.77044, 0.4507894, 0.4507894,
0.4507894, 0.77044, 0.4507894,
0.4507894, 0.4507894, 0.77044
]);
var f=new Uint16Array([
0, 18, 19,
6, 20, 18,
7, 19, 20,
19, 18, 20,
4, 21, 22,
8, 23, 21,
6, 22, 23,
22, 21, 23,
2, 24, 25,
7, 26, 24,
8, 25, 26,
25, 24, 26,
7, 20, 26,
6, 23, 20,
8, 26, 23,
26, 20, 23,
0, 19, 27,
7, 28, 19,
9, 27, 28,
27, 19, 28,
2, 29, 24,
10, 30, 29,
7, 24, 30,
24, 29, 30,
5, 31, 32,
9, 33, 31,
10, 32, 33,
32, 31, 33,
9, 28, 33,
7, 30, 28,
10, 33, 30,
33, 28, 30,
0, 34, 18,
11, 35, 34,
6, 18, 35,
18, 34, 35,
3, 36, 37,
12, 38, 36,
11, 37, 38,
37, 36, 38,
4, 22, 39,
6, 40, 22,
12, 39, 40,
39, 22, 40,
6, 35, 40,
11, 38, 35,
12, 40, 38,
40, 35, 38,
0, 27, 34,
9, 41, 27,
11, 34, 41,
34, 27, 41,
5, 42, 31,
13, 43, 42,
9, 31, 43,
31, 42, 43,
3, 37, 44,
11, 45, 37,
13, 44, 45,
44, 37, 45,
11, 41, 45,
9, 43, 41,
13, 45, 43,
45, 41, 43,
1, 46, 47,
14, 48, 46,
15, 47, 48,
47, 46, 48,
2, 25, 49,
8, 50, 25,
14, 49, 50,
49, 25, 50,
4, 51, 21,
15, 52, 51,
8, 21, 52,
21, 51, 52,
15, 48, 52,
14, 50, 48,
8, 52, 50,
52, 48, 50,
1, 53, 46,
16, 54, 53,
14, 46, 54,
46, 53, 54,
5, 32, 55,
10, 56, 32,
16, 55, 56,
55, 32, 56,
2, 49, 29,
14, 57, 49,
10, 29, 57,
29, 49, 57,
14, 54, 57,
16, 56, 54,
10, 57, 56,
57, 54, 56,
1, 47, 58,
15, 59, 47,
17, 58, 59,
58, 47, 59,
4, 39, 51,
12, 60, 39,
15, 51, 60,
51, 39, 60,
3, 61, 36,
17, 62, 61,
12, 36, 62,
36, 61, 62,
17, 59, 62,
15, 60, 59,
12, 62, 60,
62, 59, 60,
1, 58, 53,
17, 63, 58,
16, 53, 63,
53, 58, 63,
3, 44, 61,
13, 64, 44,
17, 61, 64,
61, 44, 64,
5, 55, 42,
16, 65, 55,
13, 42, 65,
42, 55, 65,
16, 63, 65,
17, 64, 63,
13, 65, 64,
65, 63, 64
]);
var sphereBuf = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, sphereBuf);
gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);
var sphereIbuf = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, sphereIbuf);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);
// ****** spheres object 6 ******
var prog6  = gl.createProgram();
gl.attachShader(prog6, getShader( gl, "unnamed_chunk_1vshader6" ));
gl.attachShader(prog6, getShader( gl, "unnamed_chunk_1fshader6" ));
//  Force aPos to location 0, aCol to location 1 
gl.bindAttribLocation(prog6, 0, "aPos");
gl.bindAttribLocation(prog6, 1, "aCol");
gl.linkProgram(prog6);
var v=new Float32Array([
0.139097, -0.163907, -0.108405, 1, 0, 0, 1, 0.01308494,
0.050417, -0.142943, -0.266162, 1, 0, 0, 1, 0.01308494,
0.052746, 0.079873, 0.002022, 1, 0, 0, 1, 0.01308494,
0.151699, -0.035784, 0.063416, 1, 0, 0, 1, 0.01308494,
-0.365654, -0.064408, -0.225379, 1, 0, 0, 1, 0.01308494,
0.113564, 0.05246, -0.08103, 1, 0, 0, 1, 0.01308494,
0.186942, 0.039941, 0.092235, 1, 0, 0, 1, 0.01308494,
0.137914, -0.207381, -0.098354, 1, 0, 0, 1, 0.01308494,
0.178443, 0.098824, 0.146326, 1, 0, 0, 1, 0.01308494,
0.233349, 0.100203, 0.078377, 1, 0, 0, 1, 0.01308494,
0.150238, 0.03049, 0.077217, 1, 0, 0, 1, 0.01308494,
0.084226, -0.014441, -0.126776, 1, 0, 0, 1, 0.01308494,
-0.239338, -0.179423, -0.260759, 1, 0, 0, 1, 0.01308494,
-0.230038, -0.271933, -0.328508, 1, 0, 0, 1, 0.01308494,
0.046368, 0.128319, -0.047488, 1, 0, 0, 1, 0.01308494,
-0.251015, -0.268145, -0.180223, 1, 0, 0, 1, 0.01308494,
-0.399933, -0.049218, -0.092927, 1, 0, 0, 1, 0.01308494,
-0.006846, 0.278597, -0.013437, 1, 0, 0, 1, 0.01308494,
0.022393, 0.149123, 0.068194, 1, 0, 0, 1, 0.01308494,
-0.029551, 0.043518, -0.324471, 1, 0, 0, 1, 0.01308494,
0.165872, 0.161744, -0.030044, 1, 0, 0, 1, 0.01308494,
0.116099, 0.090731, 0.061528, 1, 0, 0, 1, 0.01308494,
-0.212399, 0.044128, -0.264373, 1, 0, 0, 1, 0.01308494,
-0.149518, 0.171705, -0.275807, 1, 0, 0, 1, 0.01308494,
-0.109074, 0.154592, -0.041238, 1, 0, 0, 1, 0.01308494,
-0.378594, -0.001028, -0.039641, 1, 0, 0, 1, 0.01308494,
0.094235, 0.051955, 0.04779, 1, 0, 0, 1, 0.01308494,
-0.034953, 0.293675, -0.146311, 1, 0, 0, 1, 0.01308494,
0.056301, 0.20283, 0.0025, 1, 0, 0, 1, 0.01308494,
-0.119432, 0.014745, -0.212858, 1, 0, 0, 1, 0.01308494,
-0.176625, -0.107823, -0.336654, 1, 0, 0, 1, 0.01308494,
-0.025006, 0.196356, 0.091431, 1, 0, 0, 1, 0.01308494,
-0.219263, 0.142996, -0.077265, 1, 0, 0, 1, 0.01308494,
-0.144342, 0.160537, -0.197647, 1, 0, 0, 1, 0.01308494,
-0.163433, 0.321068, 0.166521, 1, 0, 0, 1, 0.01308494,
-0.472161, -0.382526, -0.081965, 1, 0, 0, 1, 0.01308494,
-0.251528, -0.252496, -0.314473, 1, 0, 0, 1, 0.01308494,
-0.271793, 0.236657, 0.059002, 1, 0, 0, 1, 0.01308494,
-0.130187, 0.03775, -0.008559, 1, 0, 0, 1, 0.01308494,
-0.269761, -0.070649, -0.158571, 1, 0, 0, 1, 0.01308494,
-0.166481, -0.042579, -0.191841, 1, 0, 0, 1, 0.01308494,
-0.23146, 0.011627, -0.252747, 1, 0, 0, 1, 0.01308494,
-0.117631, 0.228305, 0.168298, 1, 0, 0, 1, 0.01308494,
-0.18027, 0.017486, -0.169064, 1, 0, 0, 1, 0.01308494,
-0.047715, 0.167811, 0.067555, 1, 0, 0, 1, 0.01308494,
-0.412871, -0.052939, 0.036466, 1, 0, 0, 1, 0.01308494,
-0.263458, 0.081906, -0.094086, 1, 0, 0, 1, 0.01308494,
-0.170934, 0.361583, -0.043057, 1, 0, 0, 1, 0.01308494,
0.03841, 0.150354, 0.056559, 1, 0, 0, 1, 0.01308494,
-0.222283, 0.052202, -0.173436, 1, 0, 0, 1, 0.01308494,
-0.21676, -0.134476, -0.041016, 1, 0, 0, 1, 0.01308494,
-0.15963, 0.152646, 0.035772, 1, 0, 0, 1, 0.01308494,
-0.116077, 0.070939, 0.002476, 1, 0, 0, 1, 0.01308494,
-0.03861, 0.322659, 0.101128, 1, 0, 0, 1, 0.01308494,
-0.214196, -0.127805, -0.143752, 1, 0, 0, 1, 0.01308494,
-0.111124, 0.142759, -0.150522, 1, 0, 0, 1, 0.01308494,
-0.456525, -0.290524, 0.277068, 1, 0, 0, 1, 0.01308494,
-0.486134, -0.448886, 0.081963, 1, 0, 0, 1, 0.01308494,
-0.343594, 0.067568, -0.081526, 1, 0, 0, 1, 0.01308494,
-0.461983, -0.310029, 0.159765, 1, 0, 0, 1, 0.01308494,
-0.148287, 0.168388, -0.179764, 1, 0, 0, 1, 0.01308494,
-0.302891, -0.366401, 0.223978, 1, 0, 0, 1, 0.01308494,
-0.13439, 0.026074, -0.004612, 1, 0, 0, 1, 0.01308494,
-0.048095, 0.174566, 0.110808, 1, 0, 0, 1, 0.01308494,
-0.155746, 0.113338, -0.139707, 1, 0, 0, 1, 0.01308494,
-0.135734, 0.179207, -0.167489, 1, 0, 0, 1, 0.01308494,
-0.429802, 0.131117, 0.358072, 1, 0, 0, 1, 0.01308494,
-0.468304, -0.048482, 0.122787, 1, 0, 0, 1, 0.01308494,
-0.423695, -0.071916, 0.043612, 1, 0, 0, 1, 0.01308494,
-0.25106, 0.21411, 0.023776, 1, 0, 0, 1, 0.01308494,
-0.016962, 0.103268, 0.170178, 1, 0, 0, 1, 0.01308494,
-0.162603, 0.09689, -0.120982, 1, 0, 0, 1, 0.01308494,
-0.039214, 0.056984, -0.007596, 1, 0, 0, 1, 0.01308494,
-0.037997, 0.043611, 0.249274, 1, 0, 0, 1, 0.01308494,
-0.278551, 0.000694, 0.046631, 1, 0, 0, 1, 0.01308494,
-0.211734, 0.211208, 0.10085, 1, 0, 0, 1, 0.01308494,
-0.165453, 0.181786, -0.006224, 1, 0, 0, 1, 0.01308494,
-0.124434, 0.165239, -0.167872, 1, 0, 0, 1, 0.01308494,
-0.375081, 0.028898, 0.234312, 1, 0, 0, 1, 0.01308494,
-0.339903, 0.121514, 0.099461, 1, 0, 0, 1, 0.01308494,
-0.338696, 0.106578, -0.055343, 1, 0, 0, 1, 0.01308494,
-0.361882, 0.022513, 0.135605, 1, 0, 0, 1, 0.01308494,
-0.071693, 0.16392, -0.200685, 1, 0, 0, 1, 0.01308494,
-0.097943, 0.116971, -0.043692, 1, 0, 0, 1, 0.01308494,
-0.219046, 0.070712, 0.096805, 1, 0, 0, 1, 0.01308494,
-0.197289, -0.045588, 0.045246, 1, 0, 0, 1, 0.01308494,
-0.007349, 0.192789, 0.021894, 1, 0, 0, 1, 0.01308494,
-0.290536, 0.02072, 0.104257, 1, 0, 0, 1, 0.01308494,
-0.298565, -0.156753, -0.044449, 1, 0, 0, 1, 0.01308494,
-0.433522, -0.012349, 0.275014, 1, 0, 0, 1, 0.01308494,
-0.435809, 0.010703, 0.11607, 1, 0, 0, 1, 0.01308494,
-0.23544, 0.291287, 0.029007, 1, 0, 0, 1, 0.01308494,
0.090266, 0.061051, 0.220721, 1, 0, 0, 1, 0.01308494,
-0.115822, 0.121189, -0.120839, 1, 0, 0, 1, 0.01308494,
-0.371097, -0.353952, 0.125975, 1, 0, 0, 1, 0.01308494,
-0.189007, -0.106168, 0.154363, 1, 0, 0, 1, 0.01308494,
-0.275788, -0.015648, 0.032217, 1, 0, 0, 1, 0.01308494,
-0.328654, -0.250094, -0.014559, 1, 0, 0, 1, 0.01308494,
-0.349333, 0.019791, 0.030253, 1, 0, 0, 1, 0.01308494,
-0.437346, -0.025391, 0.043315, 1, 0, 0, 1, 0.01308494,
-0.370008, 0.109976, 0.013169, 1, 0, 0, 1, 0.01308494,
-0.355657, 0.183744, 0.281239, 1, 0, 0, 1, 0.01308494,
-0.152533, 0.164984, -0.075476, 1, 0, 0, 1, 0.01308494,
-0.047491, 0.026877, 0.030154, 1, 0, 0, 1, 0.01308494,
-0.278857, -0.066333, 0.063187, 1, 0, 0, 1, 0.01308494,
-0.255312, -0.023908, 0.072347, 1, 0, 0, 1, 0.01308494,
-0.176737, 0.193261, 0.133541, 1, 0, 0, 1, 0.01308494,
0.090002, -0.106525, 0.027678, 0, 0, 1, 1, 0.01308494,
0.028381, -0.072966, -0.092445, 0, 0, 1, 1, 0.01308494,
0.091061, -0.092944, 0.117845, 0, 0, 1, 1, 0.01308494,
0.159422, -0.044981, 0.111452, 0, 0, 1, 1, 0.01308494,
0.16154, 0.010294, 0.025764, 0, 0, 1, 1, 0.01308494,
0.220361, -0.064145, -0.001906, 0, 0, 1, 1, 0.01308494,
0.160273, -0.00784, 0.134799, 0, 0, 1, 1, 0.01308494,
0.221941, 0.003868, 0.025284, 0, 0, 1, 1, 0.01308494,
0.206183, -0.011445, 0.099141, 0, 0, 1, 1, 0.01308494,
-0.101416, -0.145012, -0.014236, 0, 0, 1, 1, 0.01308494,
0.213947, -0.006979, 0.066267, 0, 0, 1, 1, 0.01308494,
0.219144, 0.082632, 0.02445, 0, 0, 1, 1, 0.01308494,
0.126338, 0.101011, -0.029188, 0, 0, 1, 1, 0.01308494,
0.18562, 0.045945, 0.064385, 0, 0, 1, 1, 0.01308494,
0.262711, -0.030136, 0.002102, 0, 0, 1, 1, 0.01308494,
0.217412, 0.026219, -0.030265, 0, 0, 1, 1, 0.01308494,
0.31818, -0.045089, 0.039653, 0, 0, 1, 1, 0.01308494,
0.202944, -0.064053, 0.009858, 0, 0, 1, 1, 0.01308494,
0.227171, 0.03733, 0.013075, 0, 0, 1, 1, 0.01308494,
0.192553, 0.056049, 0.056771, 0, 0, 1, 1, 0.01308494,
0.164844, -0.081293, -0.037613, 0, 0, 1, 1, 0.01308494,
0.171486, 0.01696, -0.028226, 0, 0, 1, 1, 0.01308494,
0.205906, 0.120598, -0.033278, 0, 0, 1, 1, 0.01308494,
0.150598, 0.167943, -0.040856, 0, 0, 1, 1, 0.01308494,
0.132819, 0.042804, 0.041344, 0, 0, 1, 1, 0.01308494,
0.282918, 0.07295, -0.010304, 0, 0, 1, 1, 0.01308494,
0.246211, 0.044757, -0.065616, 0, 0, 1, 1, 0.01308494,
0.264016, -0.020484, 0.038768, 0, 0, 1, 1, 0.01308494,
0.10756, -0.107151, 0.117049, 0, 0, 1, 1, 0.01308494,
0.144846, -0.19355, 0.053439, 0, 0, 1, 1, 0.01308494,
0.209978, 0.019127, -0.039405, 0, 0, 1, 1, 0.01308494,
0.146704, 0.004026, -0.07985, 0, 0, 1, 1, 0.01308494,
0.100775, -0.126714, 0.029737, 0, 0, 1, 1, 0.01308494,
0.192055, -0.022148, -0.049405, 0, 0, 1, 1, 0.01308494,
0.13976, 0.121608, -0.041182, 0, 0, 1, 1, 0.01308494,
0.095417, -0.22346, 0.126924, 0, 0, 1, 1, 0.01308494,
0.292849, -0.082411, -0.036618, 0, 0, 1, 1, 0.01308494,
0.30509, -0.002154, -0.017089, 0, 0, 1, 1, 0.01308494,
0.282935, -0.112016, 0.040939, 0, 0, 1, 1, 0.01308494,
0.135044, -0.130472, 0.063384, 0, 0, 1, 1, 0.01308494,
0.146172, -0.130217, 0.015727, 0, 0, 1, 1, 0.01308494,
0.02357, -0.129889, 0.14869, 0, 0, 1, 1, 0.01308494,
0.154119, 0.054639, 0.000159, 0, 0, 1, 1, 0.01308494,
0.115075, -0.128813, -0.094463, 0, 0, 1, 1, 0.01308494,
0.11212, 0.100961, 0.008125, 0, 0, 1, 1, 0.01308494,
0.155959, 0.01513, -0.094887, 0, 0, 1, 1, 0.01308494,
0.19411, 0.070856, 0.010587, 0, 0, 1, 1, 0.01308494,
0.255735, -0.03661, -0.102679, 0, 0, 1, 1, 0.01308494,
0.288298, -0.032727, -0.012742, 0, 0, 1, 1, 0.01308494,
0.278629, -0.064341, 0.068421, 0, 0, 1, 1, 0.01308494,
0.158071, -0.21104, 0.021644, 0, 0, 1, 1, 0.01308494,
0.077903, -0.188171, 0.098808, 0, 0, 1, 1, 0.01308494,
0.199008, -0.082276, -0.014101, 0, 0, 1, 1, 0.01308494,
0.023149, 0.088211, 0.056097, 0, 0, 1, 1, 0.01308494,
0.13842, -0.049342, -0.023989, 0, 0, 1, 1, 0.01308494,
0.175625, 0.081521, -0.012865, 0, 0, 1, 1, 0.01308494,
0.126177, -0.002209, -0.152164, 0, 0, 1, 1, 0.01308494,
0.206745, 0.017484, 0.003233, 0, 0, 1, 1, 0.01308494,
0.356259, -0.073824, 0.045822, 0, 0, 1, 1, 0.01308494,
0.266222, -0.001966, 0.022855, 0, 0, 1, 1, 0.01308494,
0.187581, -0.076627, 0.017387, 0, 0, 1, 1, 0.01308494,
0.200376, -0.060337, -0.041454, 0, 0, 1, 1, 0.01308494,
0.080707, -0.20497, 0.033135, 0, 0, 1, 1, 0.01308494,
0.202297, 0.038879, -0.053093, 0, 0, 1, 1, 0.01308494,
0.21772, -0.119369, -0.002696, 0, 0, 1, 1, 0.01308494,
0.17307, 0.132312, 0.017951, 0, 0, 1, 1, 0.01308494,
0.144183, -0.062509, -0.087643, 0, 0, 1, 1, 0.01308494,
0.096602, -0.070512, -0.042726, 0, 0, 1, 1, 0.01308494,
0.159485, 0.003783, -0.046585, 0, 0, 1, 1, 0.01308494,
0.284733, 0.040431, -0.009522, 0, 0, 1, 1, 0.01308494,
0.331901, -0.0521, -0.002445, 0, 0, 1, 1, 0.01308494,
0.176308, -0.162551, 0.059687, 0, 0, 1, 1, 0.01308494,
0.224918, -0.096582, -0.02942, 0, 0, 1, 1, 0.01308494,
0.120907, -0.187356, 0.098106, 0, 0, 1, 1, 0.01308494,
0.167561, -0.074004, 0.070567, 0, 0, 1, 1, 0.01308494,
0.170654, -0.068615, -0.02069, 0, 0, 1, 1, 0.01308494,
0.157133, 0.06728, -0.006428, 0, 0, 1, 1, 0.01308494,
0.162535, -0.116164, -0.077371, 0, 0, 1, 1, 0.01308494,
0.193616, -0.018315, -0.010747, 0, 0, 1, 1, 0.01308494,
0.093196, -0.136778, 0.10728, 0, 0, 1, 1, 0.01308494,
0.261858, -0.07325, -0.02534, 0, 0, 1, 1, 0.01308494,
0.267426, 0.011032, -0.044151, 0, 0, 1, 1, 0.01308494,
0.138376, -0.178019, -0.03778, 0, 0, 1, 1, 0.01308494,
0.10089, -0.179142, 0.101535, 0, 0, 1, 1, 0.01308494,
0.087986, -0.09613, 0.012577, 0, 0, 1, 1, 0.01308494,
0.077781, 0.028736, 0.077778, 0, 0, 1, 1, 0.01308494,
0.172924, 0.085897, 0.01648, 0, 0, 1, 1, 0.01308494,
0.194783, 0.03996, 0.072281, 0, 0, 1, 1, 0.01308494,
0.084152, -0.024205, 0.147963, 0, 0, 1, 1, 0.01308494,
0.317998, -0.016913, 0.031672, 0, 0, 1, 1, 0.01308494,
0.201819, 0.063647, 0.042197, 0, 0, 1, 1, 0.01308494,
0.197513, -0.00267, -0.001566, 0, 0, 1, 1, 0.01308494,
0.067809, -0.242666, 0.169154, 0, 0, 1, 1, 0.01308494,
0.109059, -0.092098, -0.032984, 0, 0, 1, 1, 0.01308494,
0.033104, -0.078175, -0.054937, 0, 0, 1, 1, 0.01308494,
0.131795, -0.065255, 0.056698, 0, 0, 1, 1, 0.01308494,
0.068448, -0.040864, 0.101244, 0, 0, 1, 1, 0.01308494,
0.157213, 0.05653, 0.020425, 0, 0, 1, 1, 0.01308494,
0.142794, -0.090698, -0.058751, 0, 0, 1, 1, 0.01308494,
0.279124, 0.044499, -0.023639, 0, 0, 1, 1, 0.01308494,
0.259054, -0.027535, -0.012347, 0, 0, 1, 1, 0.01308494,
0.17029, -0.169075, -0.025571, 0, 0, 1, 1, 0.01308494,
0.206317, -0.049336, 0.096799, 0, 0, 1, 1, 0.01308494
]);
var values6 = v;
var normLoc6 = gl.getAttribLocation(prog6, "aNorm");
var mvMatLoc6 = gl.getUniformLocation(prog6,"mvMatrix");
var prMatLoc6 = gl.getUniformLocation(prog6,"prMatrix");
var normMatLoc6 = gl.getUniformLocation(prog6,"normMatrix");
// ****** text object 8 ******
var prog8  = gl.createProgram();
gl.attachShader(prog8, getShader( gl, "unnamed_chunk_1vshader8" ));
gl.attachShader(prog8, getShader( gl, "unnamed_chunk_1fshader8" ));
//  Force aPos to location 0, aCol to location 1 
gl.bindAttribLocation(prog8, 0, "aPos");
gl.bindAttribLocation(prog8, 1, "aCol");
gl.linkProgram(prog8);
var texts = [
"Axis 1"
];
var texinfo = drawTextToCanvas(texts, 1);	 
var canvasX8 = texinfo.canvasX;
var canvasY8 = texinfo.canvasY;
var ofsLoc8 = gl.getAttribLocation(prog8, "aOfs");
var texture8 = gl.createTexture();
var texLoc8 = gl.getAttribLocation(prog8, "aTexcoord");
var sampler8 = gl.getUniformLocation(prog8,"uSampler");
handleLoadedTexture(texture8, document.getElementById("unnamed_chunk_1textureCanvas"));
var v=new Float32Array([
-0.0649375, -0.6043475, -0.469914, 0, -0.5, 0.5, 0.5,
-0.0649375, -0.6043475, -0.469914, 1, -0.5, 0.5, 0.5,
-0.0649375, -0.6043475, -0.469914, 1, 1.5, 0.5, 0.5,
-0.0649375, -0.6043475, -0.469914, 0, 1.5, 0.5, 0.5
]);
for (var i=0; i<1; i++) 
for (var j=0; j<4; j++) {
ind = 7*(4*i + j) + 3;
v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i]/width;
v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight/height;
v[ind] *= texinfo.widths[i]/texinfo.canvasX;
v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip 
- v[ind+1]*texinfo.textHeight)/texinfo.canvasY;
}
var f=new Uint16Array([
0, 1, 2, 0, 2, 3
]);
var buf8 = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, buf8);
gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);
var ibuf8 = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf8);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);
var mvMatLoc8 = gl.getUniformLocation(prog8,"mvMatrix");
var prMatLoc8 = gl.getUniformLocation(prog8,"prMatrix");
// ****** text object 9 ******
var prog9  = gl.createProgram();
gl.attachShader(prog9, getShader( gl, "unnamed_chunk_1vshader9" ));
gl.attachShader(prog9, getShader( gl, "unnamed_chunk_1fshader9" ));
//  Force aPos to location 0, aCol to location 1 
gl.bindAttribLocation(prog9, 0, "aPos");
gl.bindAttribLocation(prog9, 1, "aCol");
gl.linkProgram(prog9);
var texts = [
"Axis 2"
];
var texinfo = drawTextToCanvas(texts, 1);	 
var canvasX9 = texinfo.canvasX;
var canvasY9 = texinfo.canvasY;
var ofsLoc9 = gl.getAttribLocation(prog9, "aOfs");
var texture9 = gl.createTexture();
var texLoc9 = gl.getAttribLocation(prog9, "aTexcoord");
var sampler9 = gl.getUniformLocation(prog9,"uSampler");
handleLoadedTexture(texture9, document.getElementById("unnamed_chunk_1textureCanvas"));
var v=new Float32Array([
-0.647719, -0.04365151, -0.469914, 0, -0.5, 0.5, 0.5,
-0.647719, -0.04365151, -0.469914, 1, -0.5, 0.5, 0.5,
-0.647719, -0.04365151, -0.469914, 1, 1.5, 0.5, 0.5,
-0.647719, -0.04365151, -0.469914, 0, 1.5, 0.5, 0.5
]);
for (var i=0; i<1; i++) 
for (var j=0; j<4; j++) {
ind = 7*(4*i + j) + 3;
v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i]/width;
v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight/height;
v[ind] *= texinfo.widths[i]/texinfo.canvasX;
v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip 
- v[ind+1]*texinfo.textHeight)/texinfo.canvasY;
}
var f=new Uint16Array([
0, 1, 2, 0, 2, 3
]);
var buf9 = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, buf9);
gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);
var ibuf9 = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf9);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);
var mvMatLoc9 = gl.getUniformLocation(prog9,"mvMatrix");
var prMatLoc9 = gl.getUniformLocation(prog9,"prMatrix");
// ****** text object 10 ******
var prog10  = gl.createProgram();
gl.attachShader(prog10, getShader( gl, "unnamed_chunk_1vshader10" ));
gl.attachShader(prog10, getShader( gl, "unnamed_chunk_1fshader10" ));
//  Force aPos to location 0, aCol to location 1 
gl.bindAttribLocation(prog10, 0, "aPos");
gl.bindAttribLocation(prog10, 1, "aCol");
gl.linkProgram(prog10);
var texts = [
"Axis 3"
];
var texinfo = drawTextToCanvas(texts, 1);	 
var canvasX10 = texinfo.canvasX;
var canvasY10 = texinfo.canvasY;
var ofsLoc10 = gl.getAttribLocation(prog10, "aOfs");
var texture10 = gl.createTexture();
var texLoc10 = gl.getAttribLocation(prog10, "aTexcoord");
var sampler10 = gl.getUniformLocation(prog10,"uSampler");
handleLoadedTexture(texture10, document.getElementById("unnamed_chunk_1textureCanvas"));
var v=new Float32Array([
-0.647719, -0.6043475, 0.010709, 0, -0.5, 0.5, 0.5,
-0.647719, -0.6043475, 0.010709, 1, -0.5, 0.5, 0.5,
-0.647719, -0.6043475, 0.010709, 1, 1.5, 0.5, 0.5,
-0.647719, -0.6043475, 0.010709, 0, 1.5, 0.5, 0.5
]);
for (var i=0; i<1; i++) 
for (var j=0; j<4; j++) {
ind = 7*(4*i + j) + 3;
v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i]/width;
v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight/height;
v[ind] *= texinfo.widths[i]/texinfo.canvasX;
v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip 
- v[ind+1]*texinfo.textHeight)/texinfo.canvasY;
}
var f=new Uint16Array([
0, 1, 2, 0, 2, 3
]);
var buf10 = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, buf10);
gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);
var ibuf10 = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf10);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);
var mvMatLoc10 = gl.getUniformLocation(prog10,"mvMatrix");
var prMatLoc10 = gl.getUniformLocation(prog10,"prMatrix");
// ****** lines object 11 ******
var prog11  = gl.createProgram();
gl.attachShader(prog11, getShader( gl, "unnamed_chunk_1vshader11" ));
gl.attachShader(prog11, getShader( gl, "unnamed_chunk_1fshader11" ));
//  Force aPos to location 0, aCol to location 1 
gl.bindAttribLocation(prog11, 0, "aPos");
gl.bindAttribLocation(prog11, 1, "aCol");
gl.linkProgram(prog11);
var v=new Float32Array([
-0.4, -0.4749561, -0.359001,
0.2, -0.4749561, -0.359001,
-0.4, -0.4749561, -0.359001,
-0.4, -0.4965213, -0.3774865,
-0.2, -0.4749561, -0.359001,
-0.2, -0.4965213, -0.3774865,
0, -0.4749561, -0.359001,
0, -0.4965213, -0.3774865,
0.2, -0.4749561, -0.359001,
0.2, -0.4965213, -0.3774865
]);
var buf11 = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, buf11);
gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);
var mvMatLoc11 = gl.getUniformLocation(prog11,"mvMatrix");
var prMatLoc11 = gl.getUniformLocation(prog11,"prMatrix");
// ****** text object 12 ******
var prog12  = gl.createProgram();
gl.attachShader(prog12, getShader( gl, "unnamed_chunk_1vshader12" ));
gl.attachShader(prog12, getShader( gl, "unnamed_chunk_1fshader12" ));
//  Force aPos to location 0, aCol to location 1 
gl.bindAttribLocation(prog12, 0, "aPos");
gl.bindAttribLocation(prog12, 1, "aCol");
gl.linkProgram(prog12);
var texts = [
"-0.4",
"-0.2",
"0",
"0.2"
];
var texinfo = drawTextToCanvas(texts, 1);	 
var canvasX12 = texinfo.canvasX;
var canvasY12 = texinfo.canvasY;
var ofsLoc12 = gl.getAttribLocation(prog12, "aOfs");
var texture12 = gl.createTexture();
var texLoc12 = gl.getAttribLocation(prog12, "aTexcoord");
var sampler12 = gl.getUniformLocation(prog12,"uSampler");
handleLoadedTexture(texture12, document.getElementById("unnamed_chunk_1textureCanvas"));
var v=new Float32Array([
-0.4, -0.5396518, -0.4144575, 0, -0.5, 0.5, 0.5,
-0.4, -0.5396518, -0.4144575, 1, -0.5, 0.5, 0.5,
-0.4, -0.5396518, -0.4144575, 1, 1.5, 0.5, 0.5,
-0.4, -0.5396518, -0.4144575, 0, 1.5, 0.5, 0.5,
-0.2, -0.5396518, -0.4144575, 0, -0.5, 0.5, 0.5,
-0.2, -0.5396518, -0.4144575, 1, -0.5, 0.5, 0.5,
-0.2, -0.5396518, -0.4144575, 1, 1.5, 0.5, 0.5,
-0.2, -0.5396518, -0.4144575, 0, 1.5, 0.5, 0.5,
0, -0.5396518, -0.4144575, 0, -0.5, 0.5, 0.5,
0, -0.5396518, -0.4144575, 1, -0.5, 0.5, 0.5,
0, -0.5396518, -0.4144575, 1, 1.5, 0.5, 0.5,
0, -0.5396518, -0.4144575, 0, 1.5, 0.5, 0.5,
0.2, -0.5396518, -0.4144575, 0, -0.5, 0.5, 0.5,
0.2, -0.5396518, -0.4144575, 1, -0.5, 0.5, 0.5,
0.2, -0.5396518, -0.4144575, 1, 1.5, 0.5, 0.5,
0.2, -0.5396518, -0.4144575, 0, 1.5, 0.5, 0.5
]);
for (var i=0; i<4; i++) 
for (var j=0; j<4; j++) {
ind = 7*(4*i + j) + 3;
v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i]/width;
v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight/height;
v[ind] *= texinfo.widths[i]/texinfo.canvasX;
v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip 
- v[ind+1]*texinfo.textHeight)/texinfo.canvasY;
}
var f=new Uint16Array([
0, 1, 2, 0, 2, 3,
4, 5, 6, 4, 6, 7,
8, 9, 10, 8, 10, 11,
12, 13, 14, 12, 14, 15
]);
var buf12 = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, buf12);
gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);
var ibuf12 = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf12);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);
var mvMatLoc12 = gl.getUniformLocation(prog12,"mvMatrix");
var prMatLoc12 = gl.getUniformLocation(prog12,"prMatrix");
// ****** lines object 13 ******
var prog13  = gl.createProgram();
gl.attachShader(prog13, getShader( gl, "unnamed_chunk_1vshader13" ));
gl.attachShader(prog13, getShader( gl, "unnamed_chunk_1fshader13" ));
//  Force aPos to location 0, aCol to location 1 
gl.bindAttribLocation(prog13, 0, "aPos");
gl.bindAttribLocation(prog13, 1, "aCol");
gl.linkProgram(prog13);
var v=new Float32Array([
-0.513231, -0.4, -0.359001,
-0.513231, 0.2, -0.359001,
-0.513231, -0.4, -0.359001,
-0.5356456, -0.4, -0.3774865,
-0.513231, -0.2, -0.359001,
-0.5356456, -0.2, -0.3774865,
-0.513231, 0, -0.359001,
-0.5356456, 0, -0.3774865,
-0.513231, 0.2, -0.359001,
-0.5356456, 0.2, -0.3774865
]);
var buf13 = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, buf13);
gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);
var mvMatLoc13 = gl.getUniformLocation(prog13,"mvMatrix");
var prMatLoc13 = gl.getUniformLocation(prog13,"prMatrix");
// ****** text object 14 ******
var prog14  = gl.createProgram();
gl.attachShader(prog14, getShader( gl, "unnamed_chunk_1vshader14" ));
gl.attachShader(prog14, getShader( gl, "unnamed_chunk_1fshader14" ));
//  Force aPos to location 0, aCol to location 1 
gl.bindAttribLocation(prog14, 0, "aPos");
gl.bindAttribLocation(prog14, 1, "aCol");
gl.linkProgram(prog14);
var texts = [
"-0.4",
"-0.2",
"0",
"0.2"
];
var texinfo = drawTextToCanvas(texts, 1);	 
var canvasX14 = texinfo.canvasX;
var canvasY14 = texinfo.canvasY;
var ofsLoc14 = gl.getAttribLocation(prog14, "aOfs");
var texture14 = gl.createTexture();
var texLoc14 = gl.getAttribLocation(prog14, "aTexcoord");
var sampler14 = gl.getUniformLocation(prog14,"uSampler");
handleLoadedTexture(texture14, document.getElementById("unnamed_chunk_1textureCanvas"));
var v=new Float32Array([
-0.580475, -0.4, -0.4144575, 0, -0.5, 0.5, 0.5,
-0.580475, -0.4, -0.4144575, 1, -0.5, 0.5, 0.5,
-0.580475, -0.4, -0.4144575, 1, 1.5, 0.5, 0.5,
-0.580475, -0.4, -0.4144575, 0, 1.5, 0.5, 0.5,
-0.580475, -0.2, -0.4144575, 0, -0.5, 0.5, 0.5,
-0.580475, -0.2, -0.4144575, 1, -0.5, 0.5, 0.5,
-0.580475, -0.2, -0.4144575, 1, 1.5, 0.5, 0.5,
-0.580475, -0.2, -0.4144575, 0, 1.5, 0.5, 0.5,
-0.580475, 0, -0.4144575, 0, -0.5, 0.5, 0.5,
-0.580475, 0, -0.4144575, 1, -0.5, 0.5, 0.5,
-0.580475, 0, -0.4144575, 1, 1.5, 0.5, 0.5,
-0.580475, 0, -0.4144575, 0, 1.5, 0.5, 0.5,
-0.580475, 0.2, -0.4144575, 0, -0.5, 0.5, 0.5,
-0.580475, 0.2, -0.4144575, 1, -0.5, 0.5, 0.5,
-0.580475, 0.2, -0.4144575, 1, 1.5, 0.5, 0.5,
-0.580475, 0.2, -0.4144575, 0, 1.5, 0.5, 0.5
]);
for (var i=0; i<4; i++) 
for (var j=0; j<4; j++) {
ind = 7*(4*i + j) + 3;
v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i]/width;
v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight/height;
v[ind] *= texinfo.widths[i]/texinfo.canvasX;
v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip 
- v[ind+1]*texinfo.textHeight)/texinfo.canvasY;
}
var f=new Uint16Array([
0, 1, 2, 0, 2, 3,
4, 5, 6, 4, 6, 7,
8, 9, 10, 8, 10, 11,
12, 13, 14, 12, 14, 15
]);
var buf14 = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, buf14);
gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);
var ibuf14 = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf14);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);
var mvMatLoc14 = gl.getUniformLocation(prog14,"mvMatrix");
var prMatLoc14 = gl.getUniformLocation(prog14,"prMatrix");
// ****** lines object 15 ******
var prog15  = gl.createProgram();
gl.attachShader(prog15, getShader( gl, "unnamed_chunk_1vshader15" ));
gl.attachShader(prog15, getShader( gl, "unnamed_chunk_1fshader15" ));
//  Force aPos to location 0, aCol to location 1 
gl.bindAttribLocation(prog15, 0, "aPos");
gl.bindAttribLocation(prog15, 1, "aCol");
gl.linkProgram(prog15);
var v=new Float32Array([
-0.513231, -0.4749561, -0.2,
-0.513231, -0.4749561, 0.2,
-0.513231, -0.4749561, -0.2,
-0.5356456, -0.4965213, -0.2,
-0.513231, -0.4749561, 0,
-0.5356456, -0.4965213, 0,
-0.513231, -0.4749561, 0.2,
-0.5356456, -0.4965213, 0.2
]);
var buf15 = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, buf15);
gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);
var mvMatLoc15 = gl.getUniformLocation(prog15,"mvMatrix");
var prMatLoc15 = gl.getUniformLocation(prog15,"prMatrix");
// ****** text object 16 ******
var prog16  = gl.createProgram();
gl.attachShader(prog16, getShader( gl, "unnamed_chunk_1vshader16" ));
gl.attachShader(prog16, getShader( gl, "unnamed_chunk_1fshader16" ));
//  Force aPos to location 0, aCol to location 1 
gl.bindAttribLocation(prog16, 0, "aPos");
gl.bindAttribLocation(prog16, 1, "aCol");
gl.linkProgram(prog16);
var texts = [
"-0.2",
"0",
"0.2"
];
var texinfo = drawTextToCanvas(texts, 1);	 
var canvasX16 = texinfo.canvasX;
var canvasY16 = texinfo.canvasY;
var ofsLoc16 = gl.getAttribLocation(prog16, "aOfs");
var texture16 = gl.createTexture();
var texLoc16 = gl.getAttribLocation(prog16, "aTexcoord");
var sampler16 = gl.getUniformLocation(prog16,"uSampler");
handleLoadedTexture(texture16, document.getElementById("unnamed_chunk_1textureCanvas"));
var v=new Float32Array([
-0.580475, -0.5396518, -0.2, 0, -0.5, 0.5, 0.5,
-0.580475, -0.5396518, -0.2, 1, -0.5, 0.5, 0.5,
-0.580475, -0.5396518, -0.2, 1, 1.5, 0.5, 0.5,
-0.580475, -0.5396518, -0.2, 0, 1.5, 0.5, 0.5,
-0.580475, -0.5396518, 0, 0, -0.5, 0.5, 0.5,
-0.580475, -0.5396518, 0, 1, -0.5, 0.5, 0.5,
-0.580475, -0.5396518, 0, 1, 1.5, 0.5, 0.5,
-0.580475, -0.5396518, 0, 0, 1.5, 0.5, 0.5,
-0.580475, -0.5396518, 0.2, 0, -0.5, 0.5, 0.5,
-0.580475, -0.5396518, 0.2, 1, -0.5, 0.5, 0.5,
-0.580475, -0.5396518, 0.2, 1, 1.5, 0.5, 0.5,
-0.580475, -0.5396518, 0.2, 0, 1.5, 0.5, 0.5
]);
for (var i=0; i<3; i++) 
for (var j=0; j<4; j++) {
ind = 7*(4*i + j) + 3;
v[ind+2] = 2*(v[ind]-v[ind+2])*texinfo.widths[i]/width;
v[ind+3] = 2*(v[ind+1]-v[ind+3])*texinfo.textHeight/height;
v[ind] *= texinfo.widths[i]/texinfo.canvasX;
v[ind+1] = 1.0-(texinfo.offset + i*texinfo.skip 
- v[ind+1]*texinfo.textHeight)/texinfo.canvasY;
}
var f=new Uint16Array([
0, 1, 2, 0, 2, 3,
4, 5, 6, 4, 6, 7,
8, 9, 10, 8, 10, 11
]);
var buf16 = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, buf16);
gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);
var ibuf16 = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf16);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.STATIC_DRAW);
var mvMatLoc16 = gl.getUniformLocation(prog16,"mvMatrix");
var prMatLoc16 = gl.getUniformLocation(prog16,"prMatrix");
// ****** lines object 17 ******
var prog17  = gl.createProgram();
gl.attachShader(prog17, getShader( gl, "unnamed_chunk_1vshader17" ));
gl.attachShader(prog17, getShader( gl, "unnamed_chunk_1fshader17" ));
//  Force aPos to location 0, aCol to location 1 
gl.bindAttribLocation(prog17, 0, "aPos");
gl.bindAttribLocation(prog17, 1, "aCol");
gl.linkProgram(prog17);
var v=new Float32Array([
-0.513231, -0.4749561, -0.359001,
-0.513231, 0.3876531, -0.359001,
-0.513231, -0.4749561, 0.380419,
-0.513231, 0.3876531, 0.380419,
-0.513231, -0.4749561, -0.359001,
-0.513231, -0.4749561, 0.380419,
-0.513231, 0.3876531, -0.359001,
-0.513231, 0.3876531, 0.380419,
-0.513231, -0.4749561, -0.359001,
0.3833559, -0.4749561, -0.359001,
-0.513231, -0.4749561, 0.380419,
0.3833559, -0.4749561, 0.380419,
-0.513231, 0.3876531, -0.359001,
0.3833559, 0.3876531, -0.359001,
-0.513231, 0.3876531, 0.380419,
0.3833559, 0.3876531, 0.380419,
0.3833559, -0.4749561, -0.359001,
0.3833559, 0.3876531, -0.359001,
0.3833559, -0.4749561, 0.380419,
0.3833559, 0.3876531, 0.380419,
0.3833559, -0.4749561, -0.359001,
0.3833559, -0.4749561, 0.380419,
0.3833559, 0.3876531, -0.359001,
0.3833559, 0.3876531, 0.380419
]);
var buf17 = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, buf17);
gl.bufferData(gl.ARRAY_BUFFER, v, gl.STATIC_DRAW);
var mvMatLoc17 = gl.getUniformLocation(prog17,"mvMatrix");
var prMatLoc17 = gl.getUniformLocation(prog17,"prMatrix");
gl.enable(gl.DEPTH_TEST);
gl.depthFunc(gl.LEQUAL);
gl.clearDepth(1.0);
gl.clearColor(1, 1, 1, 1);
var xOffs = yOffs = 0,  drag  = 0;
drawScene();
function drawScene(){
gl.depthMask(true);
gl.disable(gl.BLEND);
var radius = 0.7728352;
var s = sin(fov*PI/360);
var t = tan(fov*PI/360);
var distance = radius/s;
var near = distance - radius;
var far = distance + radius;
var hlen = t*near;
var aspect = width/height;
prMatrix.makeIdentity();
if (aspect > 1)
prMatrix.frustum(-hlen*aspect*zoom, hlen*aspect*zoom, 
-hlen*zoom, hlen*zoom, near, far);
else  
prMatrix.frustum(-hlen*zoom, hlen*zoom, 
-hlen*zoom/aspect, hlen*zoom/aspect, 
near, far);
mvMatrix.makeIdentity();
mvMatrix.translate( 0.0649375, 0.04365151, -0.010709 );
mvMatrix.scale( 0.9319838, 0.9686942, 1.130081 );   
mvMatrix.multRight( userMatrix );  
mvMatrix.translate(0, 0, -distance);
normMatrix.makeIdentity();
normMatrix.scale( 1.07298, 1.032318, 0.8848924 );   
normMatrix.multRight( userMatrix );
gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
// ****** spheres object 6 *******
gl.useProgram(prog6);
gl.bindBuffer(gl.ARRAY_BUFFER, sphereBuf);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, sphereIbuf);
gl.uniformMatrix4fv( prMatLoc6, false, new Float32Array(prMatrix.getAsArray()) );
gl.uniformMatrix4fv( mvMatLoc6, false, new Float32Array(mvMatrix.getAsArray()) );
gl.uniformMatrix4fv( normMatLoc6, false, new Float32Array(normMatrix.getAsArray()) );
gl.enableVertexAttribArray( posLoc );
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 12,  0);
gl.enableVertexAttribArray(normLoc6 );
gl.vertexAttribPointer(normLoc6,  3, gl.FLOAT, false, 12,  0);
gl.disableVertexAttribArray( colLoc );
var sphereNorm = new CanvasMatrix4();
sphereNorm.scale(0.9319838, 0.9686942, 1.130081);
sphereNorm.multRight(normMatrix);
gl.uniformMatrix4fv( normMatLoc6, false, new Float32Array(sphereNorm.getAsArray()) );
for (var i = 0; i < 210; i++) {
var sphereMV = new CanvasMatrix4();
var baseofs = i*8
var ofs = baseofs + 7;	       
var scale = values6[ofs];
sphereMV.scale(1.07298*scale, 1.032318*scale, 0.8848924*scale);
sphereMV.translate(values6[baseofs], 
values6[baseofs+1], 
values6[baseofs+2]);
sphereMV.multRight(mvMatrix);
gl.uniformMatrix4fv( mvMatLoc6, false, new Float32Array(sphereMV.getAsArray()) );
ofs = baseofs + 3;       
gl.vertexAttrib4f( colLoc, values6[ofs], 
values6[ofs+1], 
values6[ofs+2],
values6[ofs+3] );
gl.drawElements(gl.TRIANGLES, 384, gl.UNSIGNED_SHORT, 0);
}
// ****** text object 8 *******
gl.useProgram(prog8);
gl.bindBuffer(gl.ARRAY_BUFFER, buf8);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf8);
gl.uniformMatrix4fv( prMatLoc8, false, new Float32Array(prMatrix.getAsArray()) );
gl.uniformMatrix4fv( mvMatLoc8, false, new Float32Array(mvMatrix.getAsArray()) );
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.enableVertexAttribArray( texLoc8 );
gl.vertexAttribPointer(texLoc8, 2, gl.FLOAT, false, 28, 12);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, texture8);
gl.uniform1i( sampler8, 0);
gl.enableVertexAttribArray( ofsLoc8 );
gl.vertexAttribPointer(ofsLoc8, 2, gl.FLOAT, false, 28, 20);
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 28,  0);
gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);
// ****** text object 9 *******
gl.useProgram(prog9);
gl.bindBuffer(gl.ARRAY_BUFFER, buf9);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf9);
gl.uniformMatrix4fv( prMatLoc9, false, new Float32Array(prMatrix.getAsArray()) );
gl.uniformMatrix4fv( mvMatLoc9, false, new Float32Array(mvMatrix.getAsArray()) );
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.enableVertexAttribArray( texLoc9 );
gl.vertexAttribPointer(texLoc9, 2, gl.FLOAT, false, 28, 12);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, texture9);
gl.uniform1i( sampler9, 0);
gl.enableVertexAttribArray( ofsLoc9 );
gl.vertexAttribPointer(ofsLoc9, 2, gl.FLOAT, false, 28, 20);
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 28,  0);
gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);
// ****** text object 10 *******
gl.useProgram(prog10);
gl.bindBuffer(gl.ARRAY_BUFFER, buf10);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf10);
gl.uniformMatrix4fv( prMatLoc10, false, new Float32Array(prMatrix.getAsArray()) );
gl.uniformMatrix4fv( mvMatLoc10, false, new Float32Array(mvMatrix.getAsArray()) );
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.enableVertexAttribArray( texLoc10 );
gl.vertexAttribPointer(texLoc10, 2, gl.FLOAT, false, 28, 12);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, texture10);
gl.uniform1i( sampler10, 0);
gl.enableVertexAttribArray( ofsLoc10 );
gl.vertexAttribPointer(ofsLoc10, 2, gl.FLOAT, false, 28, 20);
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 28,  0);
gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);
// ****** lines object 11 *******
gl.useProgram(prog11);
gl.bindBuffer(gl.ARRAY_BUFFER, buf11);
gl.uniformMatrix4fv( prMatLoc11, false, new Float32Array(prMatrix.getAsArray()) );
gl.uniformMatrix4fv( mvMatLoc11, false, new Float32Array(mvMatrix.getAsArray()) );
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.lineWidth( 1 );
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 12,  0);
gl.drawArrays(gl.LINES, 0, 10);
// ****** text object 12 *******
gl.useProgram(prog12);
gl.bindBuffer(gl.ARRAY_BUFFER, buf12);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf12);
gl.uniformMatrix4fv( prMatLoc12, false, new Float32Array(prMatrix.getAsArray()) );
gl.uniformMatrix4fv( mvMatLoc12, false, new Float32Array(mvMatrix.getAsArray()) );
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.enableVertexAttribArray( texLoc12 );
gl.vertexAttribPointer(texLoc12, 2, gl.FLOAT, false, 28, 12);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, texture12);
gl.uniform1i( sampler12, 0);
gl.enableVertexAttribArray( ofsLoc12 );
gl.vertexAttribPointer(ofsLoc12, 2, gl.FLOAT, false, 28, 20);
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 28,  0);
gl.drawElements(gl.TRIANGLES, 24, gl.UNSIGNED_SHORT, 0);
// ****** lines object 13 *******
gl.useProgram(prog13);
gl.bindBuffer(gl.ARRAY_BUFFER, buf13);
gl.uniformMatrix4fv( prMatLoc13, false, new Float32Array(prMatrix.getAsArray()) );
gl.uniformMatrix4fv( mvMatLoc13, false, new Float32Array(mvMatrix.getAsArray()) );
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.lineWidth( 1 );
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 12,  0);
gl.drawArrays(gl.LINES, 0, 10);
// ****** text object 14 *******
gl.useProgram(prog14);
gl.bindBuffer(gl.ARRAY_BUFFER, buf14);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf14);
gl.uniformMatrix4fv( prMatLoc14, false, new Float32Array(prMatrix.getAsArray()) );
gl.uniformMatrix4fv( mvMatLoc14, false, new Float32Array(mvMatrix.getAsArray()) );
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.enableVertexAttribArray( texLoc14 );
gl.vertexAttribPointer(texLoc14, 2, gl.FLOAT, false, 28, 12);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, texture14);
gl.uniform1i( sampler14, 0);
gl.enableVertexAttribArray( ofsLoc14 );
gl.vertexAttribPointer(ofsLoc14, 2, gl.FLOAT, false, 28, 20);
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 28,  0);
gl.drawElements(gl.TRIANGLES, 24, gl.UNSIGNED_SHORT, 0);
// ****** lines object 15 *******
gl.useProgram(prog15);
gl.bindBuffer(gl.ARRAY_BUFFER, buf15);
gl.uniformMatrix4fv( prMatLoc15, false, new Float32Array(prMatrix.getAsArray()) );
gl.uniformMatrix4fv( mvMatLoc15, false, new Float32Array(mvMatrix.getAsArray()) );
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.lineWidth( 1 );
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 12,  0);
gl.drawArrays(gl.LINES, 0, 8);
// ****** text object 16 *******
gl.useProgram(prog16);
gl.bindBuffer(gl.ARRAY_BUFFER, buf16);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf16);
gl.uniformMatrix4fv( prMatLoc16, false, new Float32Array(prMatrix.getAsArray()) );
gl.uniformMatrix4fv( mvMatLoc16, false, new Float32Array(mvMatrix.getAsArray()) );
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.enableVertexAttribArray( texLoc16 );
gl.vertexAttribPointer(texLoc16, 2, gl.FLOAT, false, 28, 12);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, texture16);
gl.uniform1i( sampler16, 0);
gl.enableVertexAttribArray( ofsLoc16 );
gl.vertexAttribPointer(ofsLoc16, 2, gl.FLOAT, false, 28, 20);
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 28,  0);
gl.drawElements(gl.TRIANGLES, 18, gl.UNSIGNED_SHORT, 0);
// ****** lines object 17 *******
gl.useProgram(prog17);
gl.bindBuffer(gl.ARRAY_BUFFER, buf17);
gl.uniformMatrix4fv( prMatLoc17, false, new Float32Array(prMatrix.getAsArray()) );
gl.uniformMatrix4fv( mvMatLoc17, false, new Float32Array(mvMatrix.getAsArray()) );
gl.enableVertexAttribArray( posLoc );
gl.disableVertexAttribArray( colLoc );
gl.vertexAttrib4f( colLoc, 0, 0, 0, 1 );
gl.lineWidth( 1 );
gl.vertexAttribPointer(posLoc,  3, gl.FLOAT, false, 12,  0);
gl.drawArrays(gl.LINES, 0, 24);
gl.flush ();
}
var vlen = function(v) {
return sqrt(v[0]*v[0] + v[1]*v[1] + v[2]*v[2])
}
var xprod = function(a, b) {
return [a[1]*b[2] - a[2]*b[1],
a[2]*b[0] - a[0]*b[2],
a[0]*b[1] - a[1]*b[0]];
}
var screenToVector = function(x, y) {
var radius = max(width, height)/2.0;
var cx = width/2.0;
var cy = height/2.0;
var px = (x-cx)/radius;
var py = (y-cy)/radius;
var plen = sqrt(px*px+py*py);
if (plen > 1.e-6) { 
px = px/plen;
py = py/plen;
}
var angle = (SQRT2 - plen)/SQRT2*PI/2;
var z = sin(angle);
var zlen = sqrt(1.0 - z*z);
px = px * zlen;
py = py * zlen;
return [px, py, z];
}
var rotBase;
var trackballdown = function(x,y) {
rotBase = screenToVector(x, y);
saveMat.load(userMatrix);
}
var trackballmove = function(x,y) {
var rotCurrent = screenToVector(x,y);
var dot = rotBase[0]*rotCurrent[0] + 
rotBase[1]*rotCurrent[1] + 
rotBase[2]*rotCurrent[2];
var angle = acos( dot/vlen(rotBase)/vlen(rotCurrent) )*180./PI;
var axis = xprod(rotBase, rotCurrent);
userMatrix.load(saveMat);
userMatrix.rotate(angle, axis[0], axis[1], axis[2]);
drawScene();
}
var y0zoom = 0;
var zoom0 = 1;
var zoomdown = function(x, y) {
y0zoom = y;
zoom0 = log(zoom);
}
var zoommove = function(x, y) {
zoom = exp(zoom0 + (y-y0zoom)/height);
drawScene();
}
var y0fov = 0;
var fov0 = 1;
var fovdown = function(x, y) {
y0fov = y;
fov0 = fov;
}
var fovmove = function(x, y) {
fov = max(1, min(179, fov0 + 180*(y-y0fov)/height));
drawScene();
}
var mousedown = [trackballdown, zoomdown, fovdown];
var mousemove = [trackballmove, zoommove, fovmove];
function relMouseCoords(event){
var totalOffsetX = 0;
var totalOffsetY = 0;
var currentElement = canvas;
do{
totalOffsetX += currentElement.offsetLeft;
totalOffsetY += currentElement.offsetTop;
}
while(currentElement = currentElement.offsetParent)
var canvasX = event.pageX - totalOffsetX;
var canvasY = event.pageY - totalOffsetY;
return {x:canvasX, y:canvasY}
}
canvas.onmousedown = function ( ev ){
if (!ev.which) // Use w3c defns in preference to MS
switch (ev.button) {
case 0: ev.which = 1; break;
case 1: 
case 4: ev.which = 2; break;
case 2: ev.which = 3;
}
drag = ev.which;
var f = mousedown[drag-1];
if (f) {
var coords = relMouseCoords(ev);
f(coords.x, height-coords.y); 
ev.preventDefault();
}
}    
canvas.onmouseup = function ( ev ){	
drag = 0;
}
canvas.onmouseout = canvas.onmouseup;
canvas.onmousemove = function ( ev ){
if ( drag == 0 ) return;
var f = mousemove[drag-1];
if (f) {
var coords = relMouseCoords(ev);
f(coords.x, height-coords.y);
}
}
var wheelHandler = function(ev) {
var del = 1.1;
if (ev.shiftKey) del = 1.01;
var ds = ((ev.detail || ev.wheelDelta) > 0) ? del : (1 / del);
zoom *= ds;
drawScene();
ev.preventDefault();
};
canvas.addEventListener("DOMMouseScroll", wheelHandler, false);
canvas.addEventListener("mousewheel", wheelHandler, false);
}
</script>
<canvas id="unnamed_chunk_1canvas" width="1" height="1"></canvas> 
<p id="unnamed_chunk_1debug">
You must enable Javascript to view this page properly.</p>
<script>unnamed_chunk_1webGLStart();</script>

---

## Gameplan
* Run example dataset through [MiSeq SOP](http://www.mothur.org/wiki/MiSeq_SOP) 
* Work through alpha and beta diversity analysis methods and population-level analyses
* Dataset comes from a study of C57BL/6 mice that were sampled for 6 months. Study was [originally published](http://www.ncbi.nlm.nih.gov/pubmed/22688727) in Gut Microbes
